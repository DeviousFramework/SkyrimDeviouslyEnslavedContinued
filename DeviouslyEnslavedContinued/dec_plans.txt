; verstort 2/2019
; this is more notes at this point than just plans
;  keep in mind: the only part that gets modified frequently is the todo section


known bugs: (these are long term bugs, attempted to fix and failed, or dont care enough to fix)
  player's inventory is not checked at the start of a fresh load
    
  Containers searched keeps going up regardless of if you have a follower
    Doesn't reset on new followers either
  Containers resets if the forcegreet starts, but if it cancels the containers doesn't revert
  special followers aren't considered, dom/sub are always zero for starters
    Minor thing, setting defaults for all followers can get hairy if the users want to set them

  NPC is walking away after attack, again, instead of animating... why?
    bad animation in dd4, we need to update this
    actually, getworndevice(fuzzy) was so slow it was 99% of the delay for sex, sex now starts so fast this is no longer an issue
    


Debug report form:
  DE Mod version being tested
  Does the problem persist up to two versions back?
  previous DE version before problem started?
  New game, clean save, old save (previous DE version installed)
  Versions of the following: SKSE, Maria's Eden, 
  Memory patch?  
  Can you hand me the save in addition to the log? save could have interesting information
  
  Mods to test compatibility with:
    > naked dungeons > rape quest detection maybe?
    sexy bandit captives
    lich evilynn
    > devious followers
    kidnapped and pitfall
  
  
 legend (start of the line):
 ; <- fixed, leave for a version before removing
 * <- high priority 
 + <- new feature
 - <- needs to be optimized out
 ? <- unsure if this is still a problem
 > <- focus was on this when I left
###################################################
#                                                 #
#   Don't forget to change the version number!    #
#                                                 #
###################################################
 
  ---- switching to new dcur and ddi -----
  Need to swap DDzaZAPCArmBZaDS0* files for animations, were removed in ddi 4
  
  -^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v-
    Changes to esp scheduled once it's available:

  
  -^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v^v-
  
  new items:
    pony gag, 1/2 of 5
      modify new pony suit, includes gag, tailplug among other things
    rubber cat suit is now in DDi4, small conselation though if its going to be a soft dependency
    hobble dress for follower interaction?
    regular non-harness gags
    
    round 2:
    pony boots and slave boots as se
    bondage mittens
   
  make sure for each item:
    ;mcm option exists
      MCM starting values are set < do last since we're releasing early, to keep users from stumbling onto broken code
    loaded in mods
    rolled in single or unique functions OR has separate funtion
    rolled in follower items found
    has a unique follower dialogue
    has a unique attacker dialogue
    can followers find the item in a chest
    new DD 4 rubber suit
    new DD 4 see through suit
     what other cursed loot items can we now use without cursed loot?

    
  new interactions:
    add special finding key stuff, not just pocketing it
    - removing and masterbating
    - removing and running to player for sex
    - bringing key to player for safe keeping
    ask folower to help you search for keys?
    new follower brings you dialogue for new items
    
    player "Tie me up!" "you want more??"
    
  ;we should consider speeding up the item detection by checking specific slots instead of WornHasKeyword
    !!! WAR has been declared on fuzzymatch !!!
    item detection on player:
    old double function:
      naked: old: 0.217995 new: 0.089005
      3 items: old: 1.261993  new: 0.085999
      almost everything: old: 16.864990  new: 0.145020
      huge difference, and that's with debug spouting out of the second one
    this could be a huge benefit for NPC searching too
      oh no, we do looooots of wornhaskeyword in item rolling

    
    
  --- $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ --- 

      CHECK before next major release: 
        check if piercing set to zero never makes it past stuff roll
        check if DFW leash game doesn't block DEC
        remove debug from playermonitor, or at least categorize the output of it
        remove debug from doPlayerSexFull
        change startscript "Player" to PlayerMon <- this requires save cleaning... seriousy?
        
  --- $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ --- 

Notes:
  
  Dialogue brainstorm:
  - follower dialogue for asking for unlock
      does the unlock dialogue work and make sense for most items, with context being either they put them on the player or they did not
      
      missing dialogue for already gagged, ask for sex get belt?
      missing variety for gagged talking to follower
  follower approaches player with item, only two "what did you find" possibilities, and only two "Mnn?" possibilities. need way more variety here
    - need with gagged:
      ; have: do you want more items added? with player sub
      ; need really dom follower version of adding more items
      ; can use with more dom version of follower not being added
      ; need version with follower that is not dom
      ; need version with sub follower putting it on themselves <- think we might have this one already
      ; need player showing they want it and optional dialogue to go with it
  + Follower: "actually... I wanted to be tied up instead" dialogue option if sub
  +   Can we add an animation for follower doing something with their hands until they are done (adding items to player)?
  + "do you want to be bound in the pillory for awhile, sure thing honey"
    could be a bit boring... need to figure out how to make NPCs talk without dialogue
  + what about "Oh deary, is nobody using you? lets find you some ugly fucker"

  
  can we detect what items the player is wearing that the follower put on them?
   - outcomes: 
   - no items were put on by follower (surprise, where did you find these)
   - follower items + non-follower items (surprise addition, modification?)
   - only follower items (interaction)
   - 
  
  Should get done before RC14 2:
  add alt for "what is it" if they are your master
    could really use a lot of these, but each one needs its own script and we keep crashing when working on these... why?
  if we keep the dispositions of the master on the master quest, can we detect that during dialogue condition time?
  more of the dialogue should increase follower dom tendency
  some items aren't restting follower roll chances
  if gagged and shakes head, at home or with really dom follower, good chance they do it anyway
  I think there is no unlock me please available if they have the key for it, serana had a key and I got nothing
  shout on follower doesn't work apparently
  if follower finds a petcollar, they don't always put it on themselves it seems
    make sure pet collar is working
    pet collar isn't installed, so why do we roll true for pet collar when it isn't installed?
  also add unique collars to post sex, meaning single item detection
  finish straitjacket and the other item we wanted
  
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&& (todo list starts here) &&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

  ;changed key detect before 
  ;changed key detect after
  ;DCUR is broken on new version on old save, stack dump with >100 clock tick scripts
    - actually, it was chain beasts, all the DEC scripts dumped were during that fight, makes sense, DCUR checks heavy for what item is what at remove time
  ;item being re-added was blocked by the no-after affects keyword being on, non-tested
  ;bound girls still attack player

    
    
 **** Major bug: Chastity is broken ****

  Can we check if aninations exist BEFORE we allow for an attack?
    for some reason, DCUR's new dollmaster quest doesn't count as chastity
    did we set our logic to assume they would unlock but forget to unlock? we cannot do that if in a cannot-remove situation
    
    if we want an approach, we find an NPC, 
      if player is blocked, attacker has the req key to remove items, temp remove items and sex appraoch
     ?if player is blocked, and player is blockingkeyword, stop, unless you want to make crazy key/dcur thing
      if player is blocked, attacker does NOT have key, but is slaver, temp remove items and sex approach   
      if player is blocked, attacker does NOT have key, and we don't want them to add one, we need to roll animations NOW to check if it would just drop out
    holy hell this was a bigger bug than I realized
    ;also theres a bug in checkchastity that needs fixing in log
    ;I don't think our belt removal code on sex approach can handle harnesses
    So... is busy isn't resetting the approach in reality, I'm guessing because it breaks dialogue while we're in dialogue...
    ;still to do: stop attack on full chast if no key
      chast key wasn't enough for one guy to unlock player wearing chast harness???
    ;Ideally I would fix the old chast removal in pre-sex then reuse the friendly belt option
    ;  we still need to know if we want to add items in post sex, but we need to know if its friendly or not
  ;maybe slavers should always have keys?
    they should always be able to remove now, good enough, needs testing though
  **** end bug ****    

  DCUR slut suit is not vulnerable...?
    I mean we can set it to naked but shouldn't it count without user manually selecting it?
  + idea:
    user can specify vulnerability for specific items
    ;we need to know if we can get the slots for an ARMOR in papyrus, then we can check per slot
    ;add and remove buttons, add searches known armors
  + maybe search inventory too
    we can get the slot mask for the item, which is perfect, we can search with that.
      hang on we need a way to save an armor to a file so we can identify it, ID isn't enough
    how did we store races...?
      ... we didn't, damn
    known error: if you uninstall a mod an armor will NULL out, but our code won't expect it
      currently we lose with mods anyway
    for some fucking reason checking the array length < 10 is always true, even when its 16 in the debug
      seriously what is this bug 
      DEBUGGER WOULD BE NICE
    ;move unique location in debug
    ;remove function needs a device update too    
  
  
  what does whore collar do?
  Weird bug: sex approach, NPC walks up to player but says in the open, then walks away nothing happens after that until next approach
  * Item rolled a harness, player wearing a collar, got an error and nothing instead of a swap
    ? collars are never swapped if the player is wearing a harness... huh
  more debugging in remove item functions, if you get those errors then you probably have bigger problems, don't let them be silent
  we COULD move UIExtensions to a soft requirement if we move the scripting to a separate quest... would that annoy more users?
  extra mod: change skirt slot so it doesn't clash
    requires nifscope... 
  ; fixed a bug where "yes, master/mistress" wouldn't count as a belt and replace scene
  ;bug: DEC wouldn't reset sexFromDEC if belt replace was turned on
  ;bug: followers wouldn't get frustration relief unless DEC called sex and player took part
 * all of sex needs to be retested, I made too many changes
  ;* test glance at follower dialogue is sometimes absent
    ;Follower approached the player for sex while in a city, surrounded by NPCs
    follower search was inverted, would always stop early
  ;belt bug: if punishment belt is set, game equips nothing if no punishment belt...?
  the player was talking to another NPC, at least followers should know better

  for some reason DD no longer has gag sound effects... ??
    DD is broken in testing save, damn it, don't forget double save load, and add belt too
  Follower can put on items on the player after sex
    if they do, the game doesn't start, and there is no dialogue to ask them to remove what they put on
  we should stop DCUR bound girls from ever using the player, as they were previous victims
  Leon's quest is missing in the latest dcur
    might have been fixed in .5, 


  Weird case, not sure I can replicate:
    Player is gagged, game is active, follower approaches and we get player->follower gag dialogue instead of approach dialogue

  Game release did not remove collar or belt: 
    	Line 9315: [01/14/2019 - 10:59:21PM] [CRDE] found: keyword [Keyword <zad_DeviousBelt (0A003330)>] at 9
  	Line 9316: [01/14/2019 - 10:59:21PM] [CRDE] found: keyword [Keyword <zad_DeviousGag (0A007EB8)>] at 11
    looks like it saw them, same items on slave1
 Line 5492: [01/17/2019 - 01:38:20PM] Cannot open store for class "pf_crde_followeryesmasterlikes", missing file?
	Line 5493: [01/17/2019 - 01:38:20PM] ERROR: Unable to bind script pf_crde_followeryesmasterlikes to topic info A503CC7A on <NULL quest> because their base types do not match
  
  laura:Do you think you can get the bodyguard to shut up now and then?
  
  when belt is put back on, it should also make a restraints sound
  how the heck do I remove standard SL animations I hate? surely some people have hit the limit and removed them?
  Lieto footjob 1 and 2 are female dom on male with vaginal in both cases, cannot happen in attack, cannot happen if belted
  Arrok missionary should be removed

  Caged followers < did we integrate this?

  + attackers % chance for "I am not a slave" should probably not be up to the game anymore, we should have tighter control there
  
  
  integrate with Devious mindbreak?
    ;is broken, frustration goes up to max and never lowers. stuck at 0 magicka regen
    unfortunately, this is really best suited for dialogue adjustment, which I'm not inclined to get in to
    IE, player is so frustrated they cannot say no, is so sex craved can only say yes
  devious lore? haven't tried it yet
  
  + Sub slave, that doesn't get enough attention from player, should start putting items on themselves when horny
  + player approaches follower for sex, follower requires certain items be worn during sex angrim inflence
    need follower is not interested, at all

  ?+ set min time in player game, make it extendable in 13-60 minute increments
  ? piercing weight starts at zero
  ? plugs are none, huh?

  detect cuffs for vulnerable?
    need single levels for both

  
  * follower approach ignores that there are enemies nearby that may not approach the player but would get in the way of follower dialogue
    player doesn't want follower to approach the player while sneaking/weapon drawn
    this is harder to fix than I thought... 

  if the game wasn't started, talk to follower "what is it" and they do nothing from there.
    
  + intimidation skill
  
  
  + user wants weapon spooking timer
  + maybe add some color sliders
  + fix bug where follower forgets item if they get interupted

  
  
  + if player has had sex with the npc before, different enslave dialogue
    make a dialogue for "combat plug" and belt ? huh? what is this?
  
  user wants follower dom/sub tendencies to account for sex positions; yeah that's gonna happen
  
  naked dungeons has code that can detect when entering dungeons, assuming it would also have code for detecting when the dungeon is over then
    might not be enough, we want to know when the dungeon is CLEARED too
  user wants privacy item approach and sex approach overrides, great
  
  belt re-equip after a sex does not work, or maybe serana wasn't dom enough?
  slaverun specific dialogue? "not going to unlock your belt here, too many weird people"?
  
  ;follower test for if they can remove belt needs fixing
    fixed but needs testing
    we should be able to keep track of this stuff as part of vulnerability, specifically if it has a key
    
  follower approach attempt function needs to be rewritten to make more sense
    if we're going to search through the follower list twice anyway, lets search for BOTH first, then chekc our options
  keep better track of which followers are best for attacking player
  make follower negate work for all attackers too
  
>>>>>>>>>> old: >>>>>>>>>>  
  
  check to make sure DEC can really detect the new prison overhaul
      
  
  long rewrite: we keep old array of follower found items, then add items if they are needed, faster.
  "I found a better <item> for you" alternative at item approach for dom/sub relationship
  if follower puts items on player as punishment for hitting them, keep a cooldown and don't allow follower to remove items until then
    need some dom or annoyed dialogue
  
  should we make belt an armbinder requirement? or maybe really sub first
  ;move keys from player to follower if you ask to be tied up?
  ; the player->follower dialogue overrides the follower->player dialogue
  ;item removal is not working. Non-gag release does nothing at all, and the rest 'tries' to remove items but they are still equipped state wise
  dog collar found by follower -> no gagged option to question it, just "shakes head"
  ;belt should not be punish for any of these light hearted versions
  sex, while tied up, never leads to release from items, even for the one that is dialogue to be that way
  
  single item plugs chance
  fix your struggle animations
    can we get gag detection working for PAHE dialogue? ; you mean override his dialogue with our own? we can't make a tree that big
    home: "you stop, sex with me" ignores belt
    we also need new animaitons for NPC approaches player for sex, although the animation is now FAR less important because we don't have that ~20 seconds of downtime
  ;can we detect if the player is overencombered in dialogue? if we can, we can add that as a dilogue
    ; close enough, we can detect invenory and carry, but not compare, so just inventory >= 300 for now
    needs testing
  for follower puts extra items on you, we need special added pop up dialogue

  
  add MCM modifier for approach chance for when the player is alone with the attacker
   maybe remove some dialogue or add some too
  if sleeping NPCs can attack player, we need to fix this but leave sleeping NPC can attack player as option
  
  need to tell the difference between the follower having added items and the player getting items otherwise
  user thinks "Oh right, you are still tied up... oh well, only one end needs to be open, right" leads to no belt re-adding, which 
  
  change follower found items so that special collars cannot be equipped through glib follower comments, only through experimental
  player asking to be tied up should increase reputation
  rename "actorRef" and replace with variable names that make sense in context in code
  ; set the follower's containers to zero after a request for more items

  ;tie me up items gives one more than count if items don't match
  ; rolled 3 got chains, collar, gag, belt
  ; PlayerMon.ItemScript.equipFollowerAndPlayerItems
  update removeDDs to include all items
   update it to accept a list list of available removing keys ; pretty sure I had this at one point
    possible but very slow: for all keys, compare against all DD items required keys
     otherway around, get all DD items, then get all keys needed for those items, then for each key, compare with what the NPC has
  
  ;player approaching follower requires uptodate vulnerability, but it doesn't update except before an approach
  if follower finds an item, should reduce containers searched for other nearby followers to reduce chaining
    should we reduce by volume? the more followers the more we reduce? 2 is 30% 5 is 90%?
  there should be a special follower interaction from "what did you have in mind" -> "Can I put this on?" player controls
  
  inspiration from SS, make a few generic NPC masters that can be put anywhere with generic AI and decent appearance, 
    then create a list of locations they can spawn at, to get around limited NPCs that are killable
  re-organize unique collars to not roll against single/double, but to fit under collars themselves
  
  "have you found a key for this annoying belt yet?" dom version?
  ;"I think I have akey that fits" + "not really, a little tight" doesn't really work for nipple piercings
  straitjacket multiple?
  removing one collar and adding one didn't work, just removed one collar
  ;unique collar roll ignores that we are already wearing one
  ;  needs to be added to single attacker item
  ;ddi 4 catsuit isn't used yet UNTESTED
      maybe also one for vag if naked + armbinder + gag?
    we should add a unique attacker option if already armbound and naked?
    ;did we switch the value in the item roll?
  ;swapped to singlepiercing to keep belted and non-belted as different outcomes
  
  ---
  
  belt required added to special dialogue, TODO add a special property in playermon for if gag+belt is an option
  Talk to PAHE about:
  if NPC is former follower, prevent random NPC attack, or give special dialogue
    - for now, use the new faction (which is checkable in the dialogue conditions)
  add "Is in permanent follower list" to reasons we can approach for items?
  Make sure it still works without slavestats

  
  work more on the approach follower dialogue
   + add dialogue for follower realizing you don't want to wait until you get home to be bound up
          should be a simple compare if time has expired
  ;fix equipFollowerAndPlayerItems to make sure it detects that we need a gag ; should detect much more
  recompile all that had getRandomHarnessAndStuff <- just item manupulate
  ;recompile all that used that new follower and player item function, needs more stuff
  
  follower in furniture should not approach player for stuff
    -- what the hell this should be working

   
  container check cell is NULL when we're out in the overworld... crap
  double reset is still in effect, damn it.
  boots slider
  why was unique collar rolled twice
  nearby NPC check stops follower if all of them are slaves... bad?
  User thinks kidnapped is incompatible, maybe check and fix

  + User asked for hoods and other items added
  User says the bdsm aversion can happen at positive values, two users, but no evidence?
  Follower nag lock will lockout item approach too, should it?
  +  Maybe extra dialogue, or different dialogue, if the same person appraoches you a second time, especially if you said no last time?
  + addgag: what's wrong
  + healer dialogue, follower aproaches for annoyance at no healing?
  + check POX for furniture stuff we can do
  follower gets attacked out of combat, why wouldn't they get angry?
  lower arousal of attacking NPC if follower/aggression scares them off? > requires a lot of script fragments
  + Dialogue option to beg for keys back and/or unlocking from previous items
    needs additional dialogue
  + "Tie me up" > ties you to a bondage furniture
    
  add random chance attacker already had a key (even if you have to add them yourself)
  add random chance follower already had key (even if you have to add them yourself)
    
    
  - huh?
  equipping black ebonite collar causes double equip, one on top of mutex?
  add debug to display DD version if it doesn't already show
  
  
  Lets check the follower to see if they look like an owner/master, and if not can backfire
  
  
  make sure our hasFollowers change didn't break everything, need to test with 2 slave followers
    maybe special dialogue though...
  Can we test for PAHE slave being angry?
  
  check to make sure cursed loot items cannot be super imposed * not seeing anything here...
  check to make sure the follower replaces items with the right one
  
  test maria eden again? 
  NPC analysis takes too long to work, we need to look deeper
  UI busy removed, might be an issue at some points > became issue, would interupt dialogue
  
  
  add DF API calls instead of doing everything myself...? hope this is actually useful
  add a dialogue for follower finding lucky charms from DCL if they exist

  
  check DCL quest end detection again
  check for SD+ ending slave states to see what we need to set detection for
  
      whip, harness? Piercings.
    Items: Book with DD stuff, DD vibrating spells, collar, set of items (rubber, leather, heavy collar/gag/blindfold)
  Follower game planning:
    

  detect proximity to bed for sex approach percentage (1.5?)

    Extra dialogue for in brothel/freeuse zone?
  If player is in brothel, less vulnerable (or ask for sex under assumption of whore only)?
  DCL lucky charm, maybe we can prevent the player from getting new items through dialogue if they are wearing this?
  + Maybe use UIextensions to add interface for hand-picking clothes to count as magic/wizards clothes for intimidation
    How does DD handle this? can I just make an event that catches movement once and then forget? would that be safe?
  ? Wait several seconds and disable the struggle animation for enslavement, since it doesn't self cancel
    means writing a function or two
  make it so that the follower can replace non-blocking collars, and check for it the present collar is removable through DCUR
    Specifically, grab them all in testing
  + Test all available spanking animations
      
    The whole pre-sex animation filter should be re-written with female vag suppression tag avoidance in mind, it's too hard to follow right now
    if cunnilingus is used, we need to flip the "victim" as the player is the one being sucked off which is backwards
    we should check to make sure there are oral animations available to the player?
  player is stuck performing oral on attacker if belted

    ^- gah, he actually did insert assmebler into the esp, fucking hell I'm not messing with that
  Waiting for lsm to get back to my email about skse for theft/pickpocket detection using skse

  + If slave is open, follower is horny, and has been let use slave before, might use on their own without asking you.
    If only we could let the player be "used" during that period by other people
  + Follower wants to craft something, you are to be tied up while they work
  extend want to sell -> "no way!" option

  Remove random stormcloak guy from the SD thing

EVERYTHING after this is backwards and out of date, should be cut but I'm too lazy to search through git for data

  Slavetats: detect those tattoos that count as weapons
  Does follower hit detection care about shouts yet?
    Maybe vib effect too? Orgasm effect is dangerous because of animation override.
  If anal with plug, can they cum with sound effect and notificaiton?

    
  + Notice if player is bound and struggling
  Can we detect where a DD item was equipped from? I mean we can if we're the one's putting them on at least.
  
  BUG: if you add a follower manually, one that would be detected normally, they will get twice the item count
  Maybe MCM to allow users to add extra SD+ masters..?
  
    SNAG: Cannot compile quest fragments, because the fragments are not being stored in the overwrite folder...?
    we could use some context for sex
  Can we detect which mod started sex?
  
  We can detect if the follower took items off of the player, right?
  Detection if the follower has been to CDx or Dollmakers house, where else...
  ;If SD is still acting weird, is there a way to turn off the follower acting that way?
      
      
      * but we also need to make some dialogue to go there
    * frustration while belted and ignored
    * adding items to them if sub, to player if dom
    * sex
  need more ways for frustration to manifest and dissipate
  make sure follower stops approaching after certain dialogue, not sure which one it was wouldn't stop, maybe belted + begging?
  try again to find someone somewhere who knows of a way to assign a script to a quest through MO
  make a function to check for items in followers inventory that might match what you want (keyword)
  
  Search through ME code for fix, try to compile said fix
  Fix ME becoming a whore, early, is not detected  
  
    Or can leave them alone... ?
    Can pay to free follower
    Follower on display
  If CD:
    Need list of cages/places where follower can be found
    Make sure that there's a failure option too
  Try out sold follower quest thing
  
  
    "Oh cool, a vibrator, I wonder how we could make this interesting... Oh look a harness too"
  + Can I detect when the player finds a thing in a thing? If I can, the follower can detect that and confront I think.
  + If player is attacked, and slave is attacked, maybe other NPC will rape your slave while you're busy?
 
  + PAHE if slave is angry, we can ignore respectful
  + Follower should unlock player if they have a key for new plug
           
    problem: we need to be able to tell he player what the item is and if they want to interact with it or not.
  ;If Player is already <itemed>, and player cannot wear another, needs special outcomes
  PAH following faction for detecting the difference between a slave that is following and a slave tied up on the floor
    More Follower Dom in general
  Follower sex attack needs a bdsm angle
  
  & Test master items memory, manually by added and removing manually
  
  Fix horse followers?
  
  - less than begging too
  Follower can beg to be put in bondage
  Gagged follower can still beg
  
  Need more non-equip outcomes
    complicated...
  Follower remembers if the items you are wearing were put on by them, if so no birthday dialogue
  Either add a follower cooldown on sex or make female + female orgasm 
    
    Maybe if we give them the book?
  If follower dom, can use drip spells on you for disobeying?
  Maybe we can detect exact location, and then re-use that if the player has sex there it must be a decent spot
  Instead of just player location, would be better with player bed actually

  Write a scene for multiple item adding (visbile/animated?)
  Detect other follower types?
    Maybe advertising of some kind? Gagged with paint or yoke or something?
  if master, and punishing player, might allow sex attacks?
      Certain inprovments based on gear, gag/armbinder/belt/collar/blindfold/buttplug?
    If player is enjoying sex while wearing bondage too
  if player orgasms, nearby followers notice?
  
  
  Master hit counts for healing too
  
    If we could do a keyword -> actor data structure that would be cool
    we need a way to look up per-item, not other way around
    No, multislot items are bad
    Maybe a slot based system where each slot
  Need a way to keep track of items each follower has put on the player
  NPC asks if player has ever considered slave training?
  
  Rebuild code such that it can return items as well as equip them
  Random starting positions for followers, if BOTH are set to zero and no previous knowledge (all zero) 
  
  Rubber suit wearing, maybe transparent too?
  Player/follower can't say some things if they are trained and/or levels
  If other wearing certain collars or gag or... faction?
  Also, new animations for zaz bondage stuff? How to use...
    We finally have a use for spanking... maybe.
  Slave and follower frustration
  
  Add harness text, along with an item function to add harness and stuff, not just belt and stuff
  Location in dungeon detect? and/or detect if looted something recently
  Items -> leads to sex from NPC side
  Option for follower to suggest putting the item on slave/pet/ect
  Not enough post aggressive add possible reactions

    but also one slave slot might work well enough
    we can probably create a list of nearby slaves while checking the nearby NPC list, 
    can still attack other nearby slaves?
    Can piggyback on what we already have: if NPC is not confident enough to attack player
  NPCs can approach other NPC?
  
  
  Different dialogue for if the player is already wearing stuff like this 
    
      Follower can put on the rubber collar afterward
    Rubber suit collection, 
  Items follower can find and add:

  
  NPC with bed and cage in fort sunguard annor?
  - check how much of DEC pre-sex filter can dissapear to help with the speed
    
  
    A few mod events should do it
  Add devious attributes support
  
  + Remove follower protection if they are also are bound? (armbinder + gag) 

  add dcur keys to list for detection      
  ? Black out for leon enslave, animation too  

  need to store items we remove, then add them again after, or add ANYthing after
  +kimy keys for items too
    nah, we can use the original and just fix it for ourselves, change it back
  option to use second leon instead
    gags too
  attacker useing user keys doesn't exist yet, for chasitity alone there are few enough key/belt compinations to probably get away with custom function

    not as easy as I wish it was
  if you're standing near other slaves wearing similar stuff?
  seriously, slaverun reloaded integration needs work
  test player animation adding
      
  How would stipping work as an animation anyway?

  Naked plus harness doesn't count as slave NPC, or it gets canceled some other way (the girl in SSR long house)
  Change/add dialogue for slave to slave interaction

    # not much to change, the range it the #1 reason they don't still count, followed by arousal *which I can't change* and confidence
  #Change some of the NPC search MCM variables to globals so we can use them in NPC conditions

    since slaverun local doesn't work anymore   
  add slaverun reloaded for slaverun normal turn on

  Add arousal animations # delayed, can't do without a lot more effort
  
      Is there an easy way to detect if NPC is in CDx's list of buyers? need to search
      Meaning the dynamic quest NPCs, they buy stuff so they should have his stuff
    Captured dreams random NPCs that buy CDx stuff, can I use that somehow?
    cuffs, belt, percings, plugs?
    add CD items, gold/silver I mean
  Rich detection:

        Actually doable, since the armbinder itself will cancel out the animation when walking, suposidly
      If adding armbinder, struggle animation as it's being added?  
    add stripping animation before outfits
    Fix Cursed collar start, too poorly made
    Scene for Multiple devices?
  Better interaction with adding items?
     
  Reduce time in the loop
  Add debug output for when the fragment fires off for the approach start
  
      console in game, can use "setaggressiveness and setrelationship"
    # needs knowledge on how to make the attack you
    "I'd rather die than be your slave!" <- can we exit out into combat? Might be interesting
  Fight dialogue
  itemtheme watcher/checker needs to be made
  ; change the NPC count to greyed out, and default 7
  change NPC checking to array instead of single, sorted NPC array with confidence sorting is probably best given conf is last checked
  
  Master wizards can still approach player at college?
  ;Check SD for pickpocket code
  
  Return to check out Devious Fame when 1.0 comes out, use fame to lower confidence requirement, and other things
     
  old people specific?
  immoral cities: if slave
        low armor amount?
      if uncomplient, and wearing softclothing, can strip instead of arrest   
    naked or arrested
    slaves must be naked
  whiterun: if slaverun
  force stripping

    mods can shut it off too
    that way, users can still turn it off even if the MCM isn't showing up
  change mod enabled to be a global toggle
      

    More options (slave training? running away, level detection)
    Make sure leg shackles are included? What if DDi no it's open source they can fix if they want
    Toggle on/off for certain situations (armbinder, gag, whatelse)
  Combat dialogue

      you know... none of these are commonly used by the average user, so they won't see see a performance hit..
      ForswornStory
      TIR
      Darkwind (dead mod)
      FTD
    mods that use faction detection, that might have a better option:
    move faction checks lower than quest stage checks
  plans to optimise isPlayerEnslaved()
  
  add different player response dialogue if the player is super aroused or approached while masturbating
         
    look at devious surrender again for detection, he's working on it again
      testbutton3 might give me a better hint
    test slavetats some more too
    slaverun quest forcing, to change the city
  add for testing:
  

        needs testing
    if we could magic force player into rope, followed by wiggle into armbinder, that might be cool
  consider tying up the player before sex if walk away

      has pickpocket detection? hmm...
    new SD version needs testing
    cursed loot invisible suit counts as nude (maybe already happens? on it's own?)
      ; haven't found one yet, oh well
    need a way to detect if caught, currently not seeing a condition function
  for stealing/pickpocketing
    old people specific?
    immoral cities: if slave
      naked or arrested
      slaves must be naked
    whiterun: if slaverun
  force stripping

    if player orgasmed during sex
    if alone (might not be easy to find)
    if trader, can see through clothing
    if owner, higher chance
  added risk: 

    custom scenes with certain items, like toys
    entrance with Slaves of Tamriel?
      maria eden is deprecated
    scene with maria, PO bounty hunter, 
    (pet collar)
        or an NPC (nearby even)
        safety, summon some demon to mess with you instead?
        force greet often unlocks locked doors
      cages work too, in the case of something like SD cages?
        or we need a way to walk the player to the device
        user needs to be mage I think
      use spell to teleport player, more in line with lore
    put player in zaz furniture/tie up (old idea)
  Extra enslavement ideas (and event ideas)
    
  
  send slave to SD cage instead of just to master (sd, hard)
    
    Regular colored DD gear (currently only black ebonite right?)
    CD colored items
    vel's DD infused zaz items, locking, interesting no?
    aradia might come back?? who knows
    angeli's stuff
      cursed loot rubber stuff
    dasha's items
  extra items that can be equipped:
    
    not as important on the code that runs so late in the check
    wish I could know if papyrus inlined properly, so I can use more functional programming
  rewrite canRun to be less useless, more compartimentalized
    
  player more likely to get raped while alone with deviant
   
  deprecate mcm "default value" in mcm, doesn't work anyway just wasting 20-50 lines of code
  Add enslave only option to menu so users can use Dcur sex attacks instead
  add -1 to weapon max, and check if there are any other min/maxes I forgot to include
  
  add andrew to detection during mia?
         
          
        softer training: sent to CD through other means, maria's eden to some Dom in the city, mistaken idenity
        aggressive: sent to slaverun, slaves of tamriel, CD as working slave
        introduced to new dom? There aren't enough of these mods currently.
      if the NPC thinks you have bahavior issues or need training, more likely to send you to "training" mods
        too bad we don't have a way to make Maria's eden enslavement more aggressive/relaxed, same for SD+
      will need two lists of NPCs to send in the world, one aggressive, one softer
      good use of petcollar compared to the other slavey types, needs full implementation though
      less likely to be sold, more likely to be given/taken directly
      sex is not limited to aggressive?
      half the chance of being approached by thugs?
    being enslaved by high disposition friends/allies, deserves different dialogue
      similarly, can we make the player walk up to the master in SD and pay them for your use?
    Approachers walking up and talking to your master if you're maria's eden slave, instead of talking to you
    different behavior for wearing a plugged chastity belt, or wearing CD piercings (naked requirement)

  new dialogue:
plans:
  
  higher than normal chance if thalmor?
  add furniture attack? (out of my league) (maybe)
    never found, switched to alias loading anyway
  get array of random npcs, that don't overlap? (all at once instead, one one function call?)

add spanking attack? (really, this should be implemented from the slave mods)
add furniture attack? (out of my league, maybe)?
add gag attack? (npc can gag player, context?)
add gagged attack? (gagged slaves can still aproach you, new dialogue)
  
  
  4.0 update: change ponygear over to new 4.0 pony gear
          change silver/gold items to ddi?
          swap over to DDi animation search function
          
  DFW todo: not this update, I bet this is going to introduce tons of hidden bugs, lets save it for a later release
   ; convert from tab characters to space
   add master support
   mcm: use Devious framework for vulnerability testing
   _qFramework = IsPlayerBound(), SetMaster(None, "", _qFramework.MD_CLOSE, True) GetVulnerability()
          
  
  always: new followers system needs to be tested more
  = Speed testing:
    Testing faster mods detection
    Testing if cache testing
  = need to test multiple followers for bugs
      
  Follower sold/rescue:
    Need to know if we need more than one quest per follower
    otherwise, need multiple locations where cages can be found
    select location at random, move follower there, with AI package of "do nothing" and maybe "move to location again"
    cover follower in certain gear?
  
  Follower takes you home for sex:
    Record last player home we had sex in
    bind player, teleport
     > stuff
    ends in sd enslave or just release?
    can we detect if they have a home that counts as a house? if not, last player house? if not, backup location?
  
  ItemAdding needs: CD belt + plug?
    Full CD set?
    Maybe the full set can replace everything else, so keep it open as an option even when currently locked up tight
    Harness
    
    
    &$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&
    
    Stalker idea:
    if you say no to the same person more than once, 
        they might show up in the night and rape you in your bed, assuming it's yours
        ALT: rape cave/shack in the woods
        ALT: take them back to their home/house, we need to know that they have one though, 
          and that we can bypass tresspassing
      might also take you home with them in chains?
      or tie you up and be the master in your own house instead?
      maybe also special plug and peircings and belt, can't remove?
        they will show up and unlock you if you keep sleeping in owned beds, keeping you happy?
    : wake up fade from black, bound on bed (hope this doesn't break stuff?)
      custom house maybe if I can't get it to work for all beds
      my home is your home?
    Maybe you wake up in a castle, the guy you said no to was friends of a yarl/guards?
      Could be a decent way to get throne sex animations too
    
    Follower dialogue bugs:
    Can pop up in the middle of other stuff
      Mia stuff for one
    Need arousal minimum
    Need slave appraoch, where player is slave and we're being used
    Can get items and enslavement from this sex, bad, need safer sex for follower
    Can we detect if an item was added through script or through player's action?
    
    &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    Write to MCM:
      Chance of getting follower dialogue
      Chance follower is dom/sub
      Toggle follower can sell you up river?
      
    Creation kit access req:

    TesVEdit req:
      Can we change the form ID for the training plug?
    
    &&&&&&&&&&&&&&&&&&&&&&&&&&&&
    next big release stuff:
      rename fragment XXX to pf_crde_addDDregular01.psc
      abstract attemptapproach so we can use the same logic for crime and follower
        ; crime is dead
      make nearestRefNPC return array instead of single, so we can know if there are more than one
        good NPCs for confidence, other value checks after the first, and finally group scenes    
    

###############################################################################################################
  
Ideas for dialogue:
  
  Follower asks master for better gear at CD, start quest to go get gear?
   extended: Follower tells slave that you're going shopping at one of the two stores
  Follower wants to try dom against your slave (as s+s or m+s)
  Follower wants to try sub as d+d
  Follower wants to punish you, wear gag and sit in bondage furniture for awhile, must be in an area where they can wander around? can I force the AI to wander?
  Follower wants you to fuck the dog, while wearing a pet collar (gag too?)
    need to detect if beast stuff available, or maybe just pet collar
  Can we bribe Vel into training our followers?
  if frustrated, after sex send player to slave owner for slave training
    Which mods?
  Player is horny and needs to please men (SRR)
  Player is punished by being put in yoke and other stuff, can be approached for sex, paraded or put into furniture
  I bought this at one of the shops while you were gone
     * Gagged -> "I love it when you look at me like that" alternatives
   "Hey lets try some roleplay" -> Items with timer..?
   "did being plugged in public make you hot" -> sex or something else
     Belt option like gag.
    If follower has punished the player before, thinks they aren't DOM and sub between 1 and 5, can we send them to enslavement?
    Ask follower if items can be removed
    Ask if better items can be bought
    Ask for sex because bothered by items


  ; problem with this one is that you either ignore the other prostitution mods by making your own, or make them hard requirments
  ; ME is only alt, because ME has a separate dialogue, so we can just fall onto it
  ;player is approached for sex, asks for money because is whore
    would be great if I could link directly into certain dialogue
    Slut, service me.
      How much?
      Sure thing, 50 septims.
      < if arousal is high enough, this is replaced with do it for free>
      That lump in your pants better have some coin.
      
  player is approached for sex, declines, is thrown into nearby zaz furniture
    teleport? walking is meh
    this would be a higher priority if I could get code that would allow sex in furniture without furniture replacement
  
    
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
Unanswered Modding questions:
  is there a way to turn on/off all lighting effects (reset)
  Is there a way to quiet papyrus errors or warnings that are of no consequence? no exception/error catching it seems
  Is there a way to detect if quest states have advanced?
    like an event, you can detect if the stage has increased manually with a saved variable, but doesn't buy us much over state
  Is there a way to view the current factions an actor has in-game?
    for debugging
  Is there an event for entering a scene?
    no, but you can test if in scene, works for now
  At what moment does a pre-script for dialogue actually run?s
  can we offload "is player busy" into conditional engine?
    or any other part of the heavy papyrus
  how do we get NPCs to cast spells during dialogue
  Can we fix SD so we can sleep in their house without issues?
    ; seems like no

    
**************************************************************************************************************************

ASM Discovery:

  DO NOT use "Mods.prop != None && Mods.prop == thing"
    This compiler will get the prop from the class TWICE, probably because it thinks the state can change between the expressions

    PROPGET [ID[temptressVixenRace], ID[QQZQQ010], ID[::temp35]]
		CAST [ID[::temp41], NONE]
		CMP_EQ [ID[::temp40], ID[::temp35], ID[::temp41]]
		NOT [ID[::temp40], ID[::temp40]]
		CAST [ID[::temp39], ID[::temp40]]
		JMPF [ID[::temp39], 4]
		PROPGET [ID[temptressVixenRace], ID[QQZQQ010], ID[::temp41]]
		CMP_EQ [ID[::temp36], ID[QQZQQ029], ID[::temp41]]
		CAST [ID[::temp39], ID[::temp36]]
		JMPF [ID[::temp39], 3]
		RETURN [false]
		
  ;You should MANUALLY reuse local variables, otherwise the compiler makes a new one every single time,
  ;  per place in code, new loop? new local for that loop unless you re-specify
	;	See above where the same race we get is allocated to two different variables
	;	Different booleans are used too, even if they aren't needed further in the function
  Unlikely, but since this is byte code not machine code, it could optimize it out

  HOLY FUCKING BALLS the compiler can't rectify a double negative
  It just compiles what it sees one for one, regardless of whether it can shorten a cpu cycle off or not
 		NOT [ID[::temp22], ID[::temp22]] ; fucking pos -> neg toggle
		JMPF [ID[::temp22], 7]           ; jump on neg, instead of jump on pos
    
  This is weird, why the fuck does it need to cast from a string to an int instead of saving it as an int into the comparison??
  Almost every modern CPU instruction set lets you add a constant inline within the instruction, is this left over from xb360?
		CAST [ID[::temp391], 20]
		CMP_GE [ID[::temp393], ID[QQZQQ083], ID[::temp391]]
		CAST [ID[::temp393], ID[::temp393]]
		JMPT [ID[::temp393], 4]
		CAST [ID[::temp391], 5]
		CMP_LT [ID[::temp394], ID[QQZQQ083], ID[::temp391]]
		CAST [ID[::temp393], ID[::temp394]]
		RETURN [ID[::temp393]]

  DAMN IT getting an actorAV can HANG the fucking thread, waiting forever. Why.
  if the AV doesn't exist for the NPC make it return error at least so I can see it.
  if the NPC is broken, then... fucking put a timer on that shit?
==> CALLMETHOD GetAV ActorRef ::temp51 1 Morality
    ASSIGN actorMorality ::temp51
  
  WAT
  no seriously what fucking flag blackmagic bullshit is this
  CAST ::temp80 ::temp81
  CAST ::temp81 ::temp80
  JMPF ::temp81 13
  
    
**************************************************************************************************************************
    
  Training plug idea:
    Detects who master is
      If player attacks, punishes player <- need testing
      Player gets aroused from whiping
      Player orgasms, only when master does too
        Maybe only when going oral on master?
        "You longlingly think of your master " <- or something like that, if they aren't nearby and player is aroused
        "This <sex> just isn't the same as your master" <- sex with someone else, while not nearby to your master
      If player is not near master, and master is horny, can teleport player to them for sex
      distracts player if not in range of master
    If you try to remove it while still enslaved
      replaced with ghost plug
       until you put it back
       more consequences
        Disappears if you go waaaay far away from your master
          or if you put it back
          or switch masters
    Kinda want corisponding training collar
    If player goes through all training, some effects linger?
      if wearing plug, and/or after effects, cannot say no?
    If master puts a belt on you, and no plug, add this? Can we even catch this?
    
  Snags:
  Can't stop orgasm, can't allow orgasm when stopped by SLARUTIL
  Of course the belt stops orgasms so long as they have sl aroused
    but if collar or piercing...
  Could maybe get away with lowering almost all relationship ranks and such at hte start of sex, and them putting them back later...

***

Princess punishment collar:
 collar made by rich merchants and kings to punish daughters, might backfire
  can teleport player to location as temporary slave
  can bind them in shock gear
  can tie them up in painful furniture
  DM's posture pose furniture?
  temporary tattoos
 could be retrofit by the princess in later life for pleasure rather than pain
  can tie them up in 
 this might be beyond my willing threashold for pain to implement

&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

Follower Parts needed:

# old, break up and reorganize

Follower happiness:
  Follower dislikes being told no sex multiple times in a row if arousal is above X (90 standard?)
  Follower dislikes being hit in combat (not sure if I can detect this)
  Follower dislikes sitting still too long in the cold (not sure if I can detect this)
  Follower dislikes being given short sex
  Follower likes being given long sex
  Follower likes getting oral especially (user set happyiness based on type of sex: oral/anal/vag/boob)
  Follower likes getting to use toys
  Follower dislikes not getting his turn

Follower submission:?
  How could we guess this personality?
  User assigned in the menu maybe?
  characteristics for 
    horny, submissive, aggressive,

Player submission:
  Based on choices
  Willingness to have sex while bound (item selection)
  would be cool if there was a reverse enslave option for having a slave, that wasn't bound, that turned on you by enslaving you instead

Dialogue: 
Chance based on Follower arousal and player arousal, follower must be X aroused for over X seconds, or reach Y arousal
Follower states he's really bothered.

Extra feature: Follower can show disapointment if the user has short sex -> reactions depending on gender and available bondage gear

# this is old, look at follower dialogue instead
player is approached by friendly NPC, because NPC has noticed player likes it (()
    
    player started:
      Hold my keys? 
      Remove my items?
      Wanna sex?
      Hey check this out! I think it might look good on you!
    
    Hey, I know you like bondage, check this out! ; can we detect dead bodies and/or area with interesting treasure
      <show item they found>
      <talk about sex shop where you can buy stuff (CD,calypses?)>
    Hey, <name> lets have sex <- needs alternative
      passive answers high chance to say no, decreases with every no
      Go fuck yourself
      Or do you need a whore? Lets head to town (passive, can only use 2-3 times in a row before he grows impatient)
        Sometimes agrees, sometimes wants something else
      Yes, but lets move
        Option for public or private, even furniture?      
      No you need to calm down
        Chastity option?
        We're in bad area (excuse)
        Gag them
        Arm tie them
      
    Hey why don't we play a game?/?//
    I've noticed how much you enjoy having sex while tied up, I know this great guy who would like to tie you up.
      submissive option -> become slve
        if there was a sex with this guy, then dialogue, that would be cool but needs more work
      aggressive no if follower is slave (intimidate)
      say no
        double checked
          ...yes: points back to above
          no 
            dropped
            submissive training (needs available mods)
            rape? needs to be rare
            sex?
              ?
              
    Want to join in?
      Added actor to array, extra for sex
  follower remarks about player while player is busy with sex tied up and/or rape orgasm    

&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
  
  when making a new testing save:
    get a follower and sex them for follower detection, breezehome
    add a weapon to the player, whip?
    get the power to pull items from mods, set to string search
    set dcur settings, dd to easy, fame tutorial off, sexlab settings
    add gag, collar, armbinder, belt to player for testing. keys
      arousing piercing and plugs for testing follower arousal
      drip spell for faster arousal
    add an item to the nearest container for quick pull testing
    make sure sexlab slow approach bed is off
    make sure the player has a vulnerable item that doesn't block any sex or dialogue
  
**************************************
  
Someone translated DEC into chinese and posted on 9damao.com:
DEC's mod description was translated Eng->CN->Eng by google so I could read it
and some amazing results:

 Why does this Ministry of Defense have a training plug? 
 ---------
 Why should I use this instead of the cursed stolen goods?
   Please feel free to use the cursed idiot. ... . The cursed loot also does not allow men to play.
 ---------
How do I save clean -> How can I save it?
* Conduct a difficult fight
 ---------
If you have any additional ideas from the SD Master, I only have a few requirements: the National People's Congress must be found in an area with at least one bed
  At present, there are very few hostesses and civilians on the list. (this was women and civilians, hostess???)
----
 Obviously, slavery was originally intended to allow the world to react to players while they were wearing slave gear and other DD/ZAPBondage gear. (thats an interesting philosphy)
  If players are found wearing such equipment, they may be approached by people in the sky  
----
 There are 5 levels of player vulnerabilities (0-4) as follows
2: Wear the following clothing naked: horse, collar, perforation, semi-naked
  
  
(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)

  Recompile boatloads of shit:
  add to ~/.bashrc: alias notepad="/c/Program\ Files/Notepad++/notepad++.exe"
  grep <thing> *.psc | while read -r line; do
    notepad &line
  done
    
    ; force error so we get a stack trace, useful when you get oddball throws                  
    actor test 
    Debug.Trace("keyword test: " + test.WornHasKeyword(libs.zad_DeviousPlug)) ; force err
    ; there's probably one that we can throw that wouldn't cause a second error?
    actor a 
    string s = "keyword test: " + test.WornHasKeyword(libs.zad_DeviousPlug)


  [8][8][8][8][8][8][8][8][8][8][8][8][8][8][8][8]
    Extra stuff I want to save goes below:
  [8][8][8][8][8][8][8][8][8][8][8][8][8][8][8][8]

      if tmp_follower != None && ( NPCMonitorScript.isWearingSlaveDD(tmp_follower) || Mods.isSlave(tmp_follower))

  Legume's christmas list
X 1. Removed .pex files.

X 2. Formatting: Removed some errant whitespace.

+ 3. Formatting: Removed Tabs from files.

X 4. Removed declaration of a few unused variables that were no longer (or never were) used.

5. crdedistanceenslave.psc: Added the Devious Framework Quest variable to the script.
TODO: This variable is set on each update (and when used).  It needs to be set when the game is loaded isntead.

6. crdedistanceenslave.psc: When enslaving the player if DFW is installed verify with that mod that slavery is allowed before attempting it.
This change has was made in several places for each of the different enslave options.

7. Fixed some compile issues with the crdeFollowerEnslaveScript script which I believe is obsolete.

8. crdeitemmanipulatescript.psc: Added checks to verify the "player" variable is set before it is used.
There was a comment suggesting that it was not set in one of the functions while other functions were assuming it is set.
TODO: Make sure it is set on game load (or on initialization as it never changes).

9. crdeitemmanipulatescript.psc: Consolidated the case of the zad_DeviousArmbinder being checked three times at once.

10. crdeitemmanipulatescript.psc: Removed access to the PlayerMon.player variable to reduce context switching  Use the local variable instead.

11. crdeitemmanipulatescript.psc: Commented out the Equip Random DD Debug.Notifications which were now in the "Get" function.
TODO: Left them there commented out in case we decide to find where they are now being equipped and move the notifications there.

12. crdeitemmanipulatescript.psc: Removed a couple of cases of getRandomUniqueCollar() checking for the player twice.

13. crdeitemmanipulatescript.psc: Added a missing "return None" to the end of getRandomUniqueCollar().
(It probably returned None by default so this doesn't change behaviour).

14. crdeitemmanipulatescript.psc: Moved the check for the player/actor wearing a harness from the get function to the equip function (equipRandomHarnessAndStuff).

15. crdeitemmanipulatescript.psc: Fixed the return for the equipRandomHarnessAndStuff() function.

16. crdeitemmanipulatescript.psc: Moved the "Checking Belt" notification from the get function to the equip function where the check is actually done.

17. crdelockingplugscript.psc: Reorganized if clauses in OnEquippedFilter() as I was having difficulty reading and understanding the code.

18. crdemcmscript.psc: Added some code to GetVersion() to set the DFW main and MCM variables.
TODO Investigate: This function is supposed to be called on each game load but that doesn't appear to be happening.

19. crdemcmscript.psc: Removed the initial empty page.

20. crdemcmscript.psc: Added a last page variable so the MCM menu opens to the last viewed page.

21. crdemcmscript.psc: Added a UpdateScript() function for initializing/updating script variables.

22. crdemcmscript.psc: Separated the large "If a_page... next page" into separate functions for each page for organization purposes.

23. crdemcmscript.psc: Updated use of the fEventTimeoutHours variable (in several places).
There is a possibility I just updated it because it was difficult for me to understand but I don't think that is the case.
I don't remember why I made this change (some time ago) but something tells me there was an actual problem with the way it was so I didn't want to loose the changes.

24. crdemcmscript.psc: Removed a second blank line between "Nighttime Options" and "Vulnerable items".  Was this intended/desired?

25. crdemcmscript.psc: Added a "DFW Compatibility" page with:
a. "Prefer DFW Behaviour" - Intended for users to be able to turn off DFW changes and keep the old functionality.  Primarily for stability in the event of unforseen problems.
b. "Security Level" - Added an option for the users to be able to lock themselves out of the menus when vulnerable.  This still needs to be applied to lockout many of the existing MCM settings.
c. "Percent Modify Vulnerability" - An option for fine tuning DFW vulnerability for this mod.
d. "Minimum Vulnerability Sex" - The minimum DFW vulnerability the player must have before she will be considered vulnerable for sex.
                                 Intended to replace most, if not all of the DEC vulnerability options but both will be used until any non-redundant vulnerabilities can be accounted for.
e. "Minimum Vulnerability Enslave" - Same as "Minimum Vulnerability Sex" but for enslavement.
f. "Percent Vulnerability Sex" - Increase the chances of sex when vulnerable.
g. "Percent Vulnerability Enslave" - Same as "Percent Vulnerability Enslave" but for enslavement.
h. "Sex Reduction When Enslaved" - Reduces (or increases) the chance of sex when enslaved by another mod.

26. crdemcmscript.psc: Removed a couple of isntances of casting a float to a float.

27. crdemodsmonitorscript.psc: If using DFW checking for the player being a slave is moved to attemptApproach()  Removed it from the isPlayerEnslaved() function.

28. crdeplayermonitorscript.psc: Removed the sslThreadLibrary as it is not used anywhere.

29. crdeplayermonitorscript.psc: Changed the use of the timeoutEnslaveGameTime variable (in several places).
There is a possibility I just updated it because it was difficult for me to understand but I don't think that is the case.
I don't remember why I made this change (some time ago) but something tells me there was an actual problem with the way it was so I didn't want to loose the changes.
It has been renamed to fLastEnslaveAttempt which holds the exact time of the enslavement attempt (we used to store the time of the end of the timeout).
One effect of this change is updating the MCM timeout after this time has been recorded can now take effect and can be used to shorten (or lengthen) the timeout.

30. crdeplayermonitorscript.psc: Changed the Thread Busy flag from a boolean to an integer.
The integer now counts down and times out automatically if the script does not clear it properly (on badly timed saves?).

31. crdeplayermonitorscript.psc: Added script version checking to each update poll of the script (to update the script).
TODO: This needs to be done on game load rather than on each version.

32. crdeplayermonitorscript.psc: If using DFW, we don't even consider the approach if the player is not vulnerable enough (according to DFW).
This is done early to reduce a lot of possible checks and load on the papyrus engine but isn't as dynamic as checking the player's vulnerability against a large number of variables, especially basing the player's vulnerability on the attacker which isn't even looked at.

33. crdeplayermonitorscript.psc: If using DFW, we don't even consider the approach if DFW reports the player cannot be enslaved and cannot engage in sex.
TODO: The approach can now be done to have the follower equip restraints on the player?  We probably want the approach to be allowed for this case if DFW reports restraints can be added to the player.

34. crdeplayermonitorscript.psc: Added a debug message when attempting the approach.

35. crdeplayermonitorscript.psc: During the enslavement attempt if the player is too far away, instead of aborting I changed it to teleport (MoveTo) the player to the agressor's location.

36. crdeplayermonitorscript.psc: During the enslavement attempt I attempt to register the agressor as the player's master and fail the enslavement if this can't be done.
I am using None as the agressor with no mod.  This means the master does not later need to be cleared but provides some basic enslavement registration.

37. crdeplayermonitorscript.psc: When enslaving the player post sex, added a check with DFW to verify the player can be enslaved.

38. crdeplayermonitorscript.psc: When adding restraints to the player post sex, added a check with DFW to verify the player can be restrained.

39. crdeplayermonitorscript.psc: If the getClosestRefActor() fails to find an actor I added code to get the nearest dominant from DFW.
I found a case during testing when DEC could not find an actor but there were some nearby and I couldn't figure out why they weren't detected.

30. crdeplayermonitorscript.psc: Changed follower_thinks_player_sub to be cumulative of several values.
I think this was a bug.  The variable was being set and then overwritten without being used in between.

40. crdeplayermonitorscript.psc: Rewrote the sex/enslavement roll in attemptApproach() to include DFW.
Added a redundant check to make sure the player is vulnerable enough and sex/enslavement is allowed.
Accounts for MCM adjustments based on current DFW vulnerability and when the player is enslaved.
Originally this would remove the need for chastity detection here if DFW is installed but with the new bChastityToggle chastity detection is now needed regardless.

41. crdeplayermonitorscript.psc: Added some code to use the DFW vulnerability in attemptApproach() when DEC decides on enslavement but detects the player is not vulnerable enough.
If we get to this point the player should already have passed the vulnerability detection and I encountered a problem where the player's vulnerability was being evaluated incorrectly.

42. crdeplayermonitorscript.psc: Changed the enslavement vulnerability check to happen only if not using DFW.  If using DFW this is done elsewhere.

43. crdeplayermonitorscript.psc: Changed the code so that if enslavement is selected but fails for any reason sex is attempted instead.

44. crdesexlabactoralias.psc: Fixed a compile error.  I believe the script is obsolete.

45. crdeslaverunscript.psc: Fixed a spelling mistake/compile error.

46. crdestartquestscript.psc: Increased the version number to 13.7.2.

47. crdetrainingeffect.psc: Fixed a compile error.  I believe the script is obsolete.

48. Topic Info Fragments: Changed the use of the timeoutEnslaveGameTime variable (in several places).
There is a possibility I just updated it because it was difficult for me to understand but I don't think that is the case.
I don't remember why I made this change (some time ago) but something tells me there was an actual problem with the way it was so I didn't want to loose the changes.
The following topic info fragments were updated accordingly:
pf_crde_enslavelonelywithnoownersight.psc
pf_crde_enslaveluckydayslavenomaster.psc
pf_crde_enslaverunningerrandsorrun.psc
pf_crde_enslaveslaverunningnomaster.psc
pf_crde_enslaveyoulookalone.psc
pf_crde_sexfreefuckservice.psc
pf_crde_sexmycockrequires.psc
pf_crde_sexmypussyrequires.psc
pf_crde_sexslutserviceme.psc
tif__080022f0.psc
tif__080022f3.psc
tif__080022f4.psc
tif__08002311.psc
tif__080038ad.psc
tif__080038ae.psc
tif__0800437b.psc
tif__0800437c.psc
tif__0800437d.psc

49. pf_crde_followergaggedaddblindfold.psc: Fixed a compile error accessing an undeclared variable.      

***** new MCM option

* references *
string[] Property genderList Auto

event OnOptionMenuOpen(int a_option)
if a_option == iGenderPrefOID
  SetMenuDialogStartIndex(iGenderPref)
  SetMenuDialogDefaultIndex(0)
  SetMenuDialogOptions(genderList)

event OnOptionMenuAccept(int a_option, int a_index)
  {Called when the user accepts a new menu entry}  
  if a_option == iGenderPrefOID
    iGenderPref = a_index
    SetMenuOptionValue(a_option, genderList[iGenderPref])

iGenderPrefMasterOID    = AddMenuOption("Master Gender Preference", genderList[iGenderPrefMaster])

*<>*
; actual
string[] Property singleVulnerabilities Auto

uhh.... can we have a none item?
[02/28/2018 - 08:00:43PM] ERROR: None is not a valid inventory item
stack:
	[ (02002B74)].DLC1SeranaLevelingScript.GetItemCount() - "<native>" Line ?
	[crdePlayerMonitor (95001827)].crdeplayermonitorscript.attemptFollowerApproach() - "crdePlayerMonitorScript.psc" Line 1228
	[crdePlayerMonitor (95001827)].crdeplayermonitorscript.attemptApproach() - "crdePlayerMonitorScript.psc" Line 938
	[crdePlayerMonitor (95001827)].crdeplayermonitorscript.OnUpdate() - "crdePlayerMonitorScript.psc" Line 250

  ; no plug
[03/05/2018 - 07:01:18PM] [DCUR] Sex attacks are disabled!
[03/05/2018 - 07:01:23PM] [CRDE] time before NPC search: 0.781998
[03/05/2018 - 07:01:23PM] [CRDE] closest npc(s): 1:Bitch
[03/05/2018 - 07:01:25PM] [SGO] UpdateLoop:Begin
[03/05/2018 - 07:01:25PM] [SGO] UpdateLoop:Done
[03/05/2018 - 07:01:26PM] [CRDE] invalid: Bitch is wearing slave DD gear
[03/05/2018 - 07:01:26PM] [CRDE] time after NPC search: 3.946991
[03/05/2018 - 07:01:27PM] [CRDE] Follower chosen randomly is Kinky Karen out of 1
[03/05/2018 - 07:01:27PM] [CRDE] Follower re-chosen randomly is Kinky Karen out of 1 after 0 rechecks
[03/05/2018 - 07:01:27PM] [CRDE] Items found by follower :0
[03/05/2018 - 07:01:27PM] [CRDE] Follower item adding roll:31.794825 need under 90.000000, containers: 90
[03/05/2018 - 07:01:27PM] [CRDE] thinks sub: 0.000000, thinks dom: 0.000000, enjoys sub: 0.000000, enjoys dom: 0.000000, frust: 0.000000, availablility: 0
[03/05/2018 - 07:01:27PM] [CRDE] Follower found items invalid, rolling random items
[03/05/2018 - 07:01:28PM] [CRDE] collar/randomPlug/belt/glovesandboots/cuffs/randomGag/harness/armbinder/randomCD/nipplePiercings/petcollar/uniqueCollar/elbowbinder/gemplug(55/50/55/30/53/80/5/15/25/20/14/35/10)
[03/05/2018 - 07:01:28PM] [CRDE] roll/total/avail/ic/kw:(90/447/0/50/ [Keyword <zad_DeviousPlug (0A003331)>])
[03/05/2018 - 07:01:28PM] [CRDE] checking follower items ...
[03/05/2018 - 07:01:28PM] [CRDE] OnUpdate time:5.782990
[03/05/2018 - 07:01:51PM] [CRDE] Player is in UI, busy
[03/05/2018 - 07:01:51PM] [CRDE] OnUpdate time:0.057007
[03/05/2018 - 07:01:53PM] [POP].::.xpoCrimeScanner: (scanning) OnUpdate
[03/05/2018 - 07:01:57PM] [CRDE] items to add:[None, None, None, None]
[03/05/2018 - 07:02:01PM] [CRDE] Player is in UI, busy
[03/05/2018 - 07:02:01PM] [CRDE] OnUpdate time:0.072998

bad animations:
gag and full belt: A: Mitos Hugging Behind tags:["FeetCum", "Dirty", "Laying", "Reverse", "Footjob", "Feet", "Fetish", "Penis", "Straight", "sex", "Mitos", "FM", "MF", ""]

[02/14/2019 - 11:43:10PM] ERROR: Unable to call GetNumItems - no native object bound to the script object, or object is of incorrect type
stack:
	[<NULL form> (FF000C8F)].ObjectReference.GetNumItems() - "<native>" Line ?
	[ (AA043322)].PRKF_crdeContainerPerk_08043322.Fragment_2() - "PRKF_crdeContainerPerk_08043322.psc" Line 15
[02/14/2019 - 11:43:10PM] ERROR: Unable to call GetCurrentStageID - no native object bound to the script object, or object is of incorrect type
stack:
	[<NULL form> (9707A009)].dcur_leonslavery_questscript.GetCurrentStageID() - "<native>" Line ?
	[<NULL form> (9707A009)].dcur_leonslavery_questscript.GetStage() - "Quest.psc" Line 64
	[alias alias_player_as on quest dcur_aliases (9705FA38)].dcur_leonslavery_PlayerRef.OnItemAdded() - "dcur_leonslavery_PlayerRef.psc" Line 8
[02/14/2019 - 11:43:10PM] warning: Assigning None to a non-object variable named "::temp0"
stack:
	[ (AA043322)].PRKF_crdeContainerPerk_08043322.Fragment_2() - "PRKF_crdeContainerPerk_08043322.psc" Line 15
[02/14/2019 - 11:43:10PM] warning: Assigning None to a non-object variable named "::temp6"
stack:
	[<NULL form> (9707A009)].dcur_leonslavery_questscript.GetStage() - "Quest.psc" Line 64
	[alias alias_player_as on quest dcur_aliases (9705FA38)].dcur_leonslavery_PlayerRef.OnItemAdded() - "dcur_leonslavery_PlayerRef.psc" Line 8

