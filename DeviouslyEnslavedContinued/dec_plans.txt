; verstort 11/2017
; this is more notes at this point than just plans
; the top is really old, from early 2015, the bottom is the most up-to-date
; search for "more recent", above it is the newest todo list, below are some notes on follower dialogue and other stuff

known bugs:
  player's inventory is not checked at the start of a fresh load
  partial chastity is always on because you set chastity bra to always true if the toggle is off
    I think we fixed this?  
    
  Containers searched keeps going up regardless of if you have a follower
    Doesn't reset on new followers either
  Containers resets if the forcegreet starts, but if it cancels the containers doesn't revert
  player is dom not really considered, and not adding correctly
  special followers aren't considered, dom/sub are always zero for starters
    Minor thing, setting defaults for all followers can get hairy if the users want to set them
  follower puts their chest back on immediately after putting on an item
    Maybe swap how it happens? Naked after items added?
    Maybe put chest on again after commenting armor can go on top of it
  Milk pump for MME isn't being detected correctly  
  NPC is walking away after attack, again, instead of animating... why?

  
Debug report form:
  DE Mod version being tested
  Does the problem persist up to two versions back?
  previous DE version before problem started?
  New game, clean save, old save (previous DE version installed)
  Versions of the following: SKSE, Maria's Eden, 
  Memory patch?  
  Can you hand me the save in addition to the log? save could have interesting information
  
 vvv------vVv------vvv THIS IS OLD, SKIP TO "more recent" vvv------vVv------vvv
 legend (start of the line):
 ; <- fixed, leave for a version before removing
 * <- high priority 
 + <- new feature
 - <- needs to be optimized out
 ? <- unsure if this is still a problem
 
add gagged attack? (gagged slaves can still aproach you, new dialogue)
add gag attack? (npc can gag player, context?)
add furniture attack? (out of my league, maybe)?
add spanking attack? (really, this should be implemented from the slave mods)

  get array of random npcs, that don't overlap? (all at once instead, one one function call?)
    never found, switched to alias loading anyway
  add furniture attack? (out of my league) (maybe)
  higher than normal chance if thalmor?
  
plans:
  new dialogue:

    different behavior for wearing a plugged chastity belt, or wearing CD piercings (naked requirement)
    Approachers walking up and talking to your master if you're maria's eden slave, instead of talking to you
      similarly, can we make the player walk up to the master in SD and pay them for your use?
    being enslaved by high disposition friends/allies, deserves different dialogue
      half the chance of being approached by thugs?
      sex is not limited to aggressive?
      less likely to be sold, more likely to be given/taken directly
      good use of petcollar compared to the other slavey types, needs full implementation though
      will need two lists of NPCs to send in the world, one aggressive, one softer
        too bad we don't have a way to make Maria's eden enslavement more aggressive/relaxed, same for SD+
      if the NPC thinks you have bahavior issues or need training, more likely to send you to "training" mods
        introduced to new dom? There aren't enough of these mods currently.
        aggressive: sent to slaverun, slaves of tamriel, CD as working slave
        softer training: sent to CD through other means, maria's eden to some Dom in the city, mistaken idenity
          
         
  add andrew to detection during mia?
  
  add -1 to weapon max, and check if there are any other min/maxes I forgot to include
  Add enslave only option to menu so users can use Dcur sex attacks instead
  deprecate mcm "default value" in mcm, doesn't work anyway just wasting 20-50 lines of code
   
  player more likely to get raped while alone with deviant
    
  rewrite canRun to be less useless, more compartimentalized
    wish I could know if papyrus inlined properly, so I can use more functional programming
    not as important on the code that runs so late in the check
    
  extra items that can be equipped:
    dasha's items
      cursed loot rubber stuff
    angeli's stuff
    aradia might come back?? who knows
    vel's DD infused zaz items, locking, interesting no?
    CD colored items
    Regular colored DD gear (currently only black ebonite right?)
    
  send slave to SD cage instead of just to master (sd, hard)
  
    
  Extra enslavement ideas (and event ideas)
    put player in zaz furniture/tie up (old idea)
      use spell to teleport player, more in line with lore
        user needs to be mage I think
        or we need a way to walk the player to the device
      cages work too, in the case of something like SD cages?
        force greet often unlocks locked doors
        safety, summon some demon to mess with you instead?
        or an NPC (nearby even)
    (pet collar)
    scene with maria, PO bounty hunter, 
      maria eden is deprecated
    entrance with Slaves of Tamriel?
    custom scenes with certain items, like toys

  added risk: 
    if owner, higher chance
    if trader, can see through clothing
    if alone (might not be easy to find)
    if player orgasmed during sex

  force stripping
    whiterun: if slaverun
      slaves must be naked
      naked or arrested
    immoral cities: if slave
    old people specific?
  for stealing/pickpocketing
    need a way to detect if caught, currently not seeing a condition function
      ; haven't found one yet, oh well
    cursed loot invisible suit counts as nude (maybe already happens? on it's own?)
    new SD version needs testing
      has pickpocket detection? hmm...

  consider tying up the player before sex if walk away
    if we could magic force player into rope, followed by wiggle into armbinder, that might be cool
        needs testing

  
  add for testing:
    slaverun quest forcing, to change the city
    test slavetats some more too
      testbutton3 might give me a better hint
    look at devious surrender again for detection, he's working on it again
         
  add different player response dialogue if the player is super aroused or approached while masturbating
  
  plans to optimise isPlayerEnslaved()
    move faction checks lower than quest stage checks
    mods that use faction detection, that might have a better option:
      FTD
      Darkwind (dead mod)
      TIR
      ForswornStory
      you know... none of these are commonly used by the average user, so they won't see see a performance hit..

  Combat dialogue
    Toggle on/off for certain situations (armbinder, gag, whatelse)
    Make sure leg shackles are included? What if DDi no it's open source they can fix if they want
    More options (slave training? running away, level detection)

      
  change mod enabled to be a global toggle
    that way, users can still turn it off even if the MCM isn't showing up
    mods can shut it off too

  force stripping
  whiterun: if slaverun
    slaves must be naked
    naked or arrested
      if uncomplient, and wearing softclothing, can strip instead of arrest   
        low armor amount?
  immoral cities: if slave
  old people specific?
     
  Return to check out Devious Fame when 1.0 comes out, use fame to lower confidence requirement, and other things
  
  ;Check SD for pickpocket code
  Master wizards can still approach player at college?
  
  change NPC checking to array instead of single, sorted NPC array with confidence sorting is probably best given conf is last checked
  ; change the NPC count to greyed out, and default 7
  itemtheme watcher/checker needs to be made
  Fight dialogue
    "I'd rather die than be your slave!" <- can we exit out into combat? Might be interesting
    # needs knowledge on how to make the attack you
      console in game, can use "setaggressiveness and setrelationship"
  
  Add debug output for when the fragment fires off for the approach start
  Reduce time in the loop
     
  Better interaction with adding items?
    Scene for Multiple devices?
    Fix Cursed collar start, too poorly made
    add stripping animation before outfits
      If adding armbinder, struggle animation as it's being added?  
        Actually doable, since the armbinder itself will cancel out the animation when walking, suposidly

  Rich detection:
    add CD items, gold/silver I mean
    cuffs, belt, percings, plugs?
    Captured dreams random NPCs that buy CDx stuff, can I use that somehow?
      Meaning the dynamic quest NPCs, they buy stuff so they should have his stuff
      Is there an easy way to detect if NPC is in CDx's list of buyers? need to search
  
  Add arousal animations # delayed, can't do without a lot more effort

  add slaverun reloaded for slaverun normal turn on
    since slaverun local doesn't work anymore   

  #Change some of the NPC search MCM variables to globals so we can use them in NPC conditions
    # not much to change, the range it the #1 reason they don't still count, followed by arousal *which I can't change* and confidence

  Change/add dialogue for slave to slave interaction
  Naked plus harness doesn't count as slave NPC, or it gets canceled some other way (the girl in SSR long house)

  How would stipping work as an animation anyway?
      
  test player animation adding
  seriously, slaverun reloaded integration needs work
  if you're standing near other slaves wearing similar stuff?
    not as easy as I wish it was

  attacker useing user keys doesn't exist yet, for chasitity alone there are few enough key/belt compinations to probably get away with custom function
    gags too
  option to use second leon instead
    nah, we can use the original and just fix it for ourselves, change it back
  +kimy keys for items too
  need to store items we remove, then add them again after, or add ANYthing after

  ? Black out for leon enslave, animation too  
  add dcur keys to list for detection      

  + Remove follower protection if they are also are bound? (armbinder + gag) 
  
  Add devious attributes support
    A few mod events should do it
  
    
  - check how much of DEC pre-sex filter can dissapear to help with the speed
  NPC with bed and cage in fort sunguard annor?
  

  Items follower can find and add:
    Rubber suit collection, 
      Follower can put on the rubber collar afterward
    
  Different dialogue for if the player is already wearing stuff like this 
  
  
  NPCs can approach other NPC?
    Can piggyback on what we already have: if NPC is not confident enough to attack player
    can still attack other nearby slaves?
    we can probably create a list of nearby slaves while checking the nearby NPC list, 
    but also one slave slot might work well enough

  Not enough post aggressive add possible reactions
  Option for follower to suggest putting the item on slave/pet/ect
  Items -> leads to sex from NPC side
  Location in dungeon detect? and/or detect if looted something recently
  Add harness text, along with an item function to add harness and stuff, not just belt and stuff
  
  Slave and follower frustration
    We finally have a use for spanking... maybe.
  Also, new animations for zaz bondage stuff? How to use...
  If other wearing certain collars or gag or... faction?
  Player/follower can't say some things if they are trained and/or levels
  Rubber suit wearing, maybe transparent too?
  
  Random starting positions for followers, if BOTH are set to zero and no previous knowledge (all zero) 
  Rebuild code such that it can return items as well as equip them
  
  NPC asks if player has ever considered slave training?
  Need a way to keep track of items each follower has put on the player
    Maybe a slot based system where each slot
    No, multislot items are bad
    we need a way to look up per-item, not other way around
    If we could do a keyword -> actor data structure that would be cool
  
  Master hit counts for healing too
  
  
  if player orgasms, nearby followers notice?
    If player is enjoying sex while wearing bondage too
      Certain inprovments based on gear, gag/armbinder/belt/collar/blindfold/buttplug?
  if master, and punishing player, might allow sex attacks?
    Maybe advertising of some kind? Gagged with paint or yoke or something?
  Detect other follower types?
  Write a scene for multiple item adding (visbile/animated?)

  Instead of just player location, would be better with player bed actually
  Maybe we can detect exact location, and then re-use that if the player has sex there it must be a decent spot
  If follower dom, can use drip spells on you for disobeying?
    Maybe if we give them the book?
    
  Either add a follower cooldown on sex or make female + female orgasm 
  Follower remembers if the items you are wearing were put on by them, if so no birthday dialogue
    complicated...
  Need more non-equip outcomes
  
  Gagged follower can still beg
  Follower can beg to be put in bondage
  - less than begging too
  
  Fix horse followers?
  
  & Test master items memory, manually by added and removing manually
  
  Follower sex attack needs a bdsm angle
    More Follower Dom in general
  PAH following faction for detecting the difference between a slave that is following and a slave tied up on the floor
  ;If Player is already <itemed>, and player cannot wear another, needs special outcomes
    problem: we need to be able to tell he player what the item is and if they want to interact with it or not.
           
  + Follower should unlock player if they have a key for new plug
  + PAHE if slave is angry, we can ignore respectful
 
  + If player is attacked, and slave is attacked, maybe other NPC will rape your slave while you're busy?
  + Can I detect when the player finds a thing in a thing? If I can, the follower can detect that and confront I think.
    "Oh cool, a vibrator, I wonder how we could make this interesting... Oh look a harness too"
  
  
  Try out sold follower quest thing
    Make sure that there's a failure option too
    Need list of cages/places where follower can be found
  If CD:
    Follower on display
    Can pay to free follower
    Or can leave them alone... ?
  
  Fix ME becoming a whore, early, is not detected  
  Search through ME code for fix, try to compile said fix
  
  make a function to check for items in followers inventory that might match what you want (keyword)
  try again to find someone somewhere who knows of a way to assign a script to a quest through MO
  make sure follower stops approaching after certain dialogue, not sure which one it was wouldn't stop, maybe belted + begging?
  need more ways for frustration to manifest and dissipate
    * sex
    * adding items to them if sub, to player if dom
    * frustration while belted and ignored
      * but we also need to make some dialogue to go there
      
      
  ;If SD is still acting weird, is there a way to turn off the follower acting that way?
  Detection if the follower has been to CDx or Dollmakers house, where else...
  We can detect if the follower took items off of the player, right?
  
  Can we detect which mod started sex?
    we could use some context for sex
    SNAG: Cannot compile quest fragments, because the fragments are not being stored in the overwrite folder...?
  
  Maybe MCM to allow users to add extra SD+ masters..?
  BUG: if you add a follower manually, one that would be detected normally, they will get twice the item count
  
  Can we detect where a DD item was equipped from? I mean we can if we're the one's putting them on at least.
  + Notice if player is bound and struggling
    

  If anal with plug, can they cum with sound effect and notificaiton?
    Maybe vib effect too? Orgasm effect is dangerous because of animation override.
  Does follower hit detection care about shouts yet?
  Slavetats: detect those tattoos that count as weapons

  ;We need to swap zbf keywords for zad keywords, or add them as additional: looks like kimy has finally scrapped ZAZ from cursed loot
  ;Sex through PAHE and PAHHSH counts as sex we should allow enslavment and items for
more recent (not mothballed either):

  Remove random stormcloak guy from the SD thing

  extend want to sell -> "no way!" option
  + Follower wants to craft something, you are to be tied up while they work
    If only we could let the player be "used" during that period by other people
  + If slave is open, follower is horny, and has been let use slave before, might use on their own without asking you.

  Waiting for lsm to get back to my email about skse for theft/pickpocket detection using skse
    ^- gah, he actually did insert assmebler into the esp, fucking hell I'm not messing with that

  player is stuck performing oral on attacker if belted
    we should check to make sure there are oral animations available to the player?
    if cunnilingus is used, we need to flip the "victim" as the player is the one being sucked off which is backwards
    The whole pre-sex animation filter should be re-written with female vag suppression tag avoidance in mind, it's too hard to follow right now
      
  + Test all available spanking animations
    Specifically, grab them all in testing
  make it so that the follower can replace non-blocking collars, and check for it the present collar is removable through DCUR
    means writing a function or two
  ? Wait several seconds and disable the struggle animation for enslavement, since it doesn't self cancel
    How does DD handle this? can I just make an event that catches movement once and then forget? would that be safe?
  + Maybe use UIextensions to add interface for hand-picking clothes to count as magic/wizards clothes for intimidation
  DCL lucky charm, maybe we can prevent the player from getting new items through dialogue if they are wearing this?
  If player is in brothel, less vulnerable (or ask for sex under assumption of whore only)?
    Extra dialogue for in brothel/freeuse zone?

  detect proximity to bed for sex approach percentage (1.5?)

    
  Follower game planning:
    Items: Book with DD stuff, DD vibrating spells, collar, set of items (rubber, leather, heavy collar/gag/blindfold)
      whip, harness? Piercings.
  
  check for SD+ ending slave states to see what we need to set detection for
  check DCL quest end detection again
  

  add a dialogue for follower finding lucky charms from DCL if they exist
  add DF API calls instead of doing everything myself...? hope this is actually useful
  
  
  UI busy removed, might be an issue at some points > became issue, would interupt dialogue
  NPC analysis takes too long to work, we need to look deeper
  test maria eden again? 
  
  check to make sure the follower replaces items with the right one
  check to make sure cursed loot items cannot be super imposed * not seeing anything here...
  
  Can we test for PAHE slave being angry?
    maybe special dialogue though...
  make sure our hasFollowers change didn't break everything, need to test with 2 slave followers
  
  
  
  Lets check the follower to see if they look like an owner/master, and if not can backfire
  ;attacker + follower 3 some if follower is horny?
  
  
  add debug to display DD version if it doesn't already show
  equipping black ebonite collar causes double equip, one on top of mutex?
  - huh?
    
  ++~~++  
    
  add random chance follower already had key (even if you have to add them yourself)
  add random chance attacker already had a key (even if you have to add them yourself)
    
  + User asked for hoods and other items added
  User says the bdsm aversion can happen at positive values, two users, but no evidence?
  Follower nag lock will lockout item approach too, should it?
  +  Maybe extra dialogue, or different dialogue, if the same person appraoches you a second time, especially if you said no last time?
  + addgag: what's wrong
  + healer dialogue, follower aproaches for annoyance at no healing?
  + check POX for furniture stuff we can do
  follower gets attacked out of combat, why wouldn't they get angry?
  lower arousal of attacking NPC if follower/aggression scares them off? > requires a lot of script fragments
  + Dialogue option to beg for keys back and/or unlocking from previous items
    needs additional dialogue
  + "Tie me up" > ties you to a bondage furniture
  Tell DD team about the loading blindfold bug

  User thinks kidnapped is incompatible, maybe check and fix
  nearby NPC check stops follower if all of them are slaves... bad?
  why was unique collar rolled twice
  boots slider
  double reset is still in effect, damn it.
  container check cell is NULL when we're out in the overworld... crap
   
  ;changed player gender in doplayersex to sexlab gender 
   
  follower in furniture should not approach player for stuff
    -- what the hell this should be working
 
  add more ddi 4.0 items, as soft dependency
 
  work more on the approach follower dialogue
   - can we fix the struggle emotes?
   + add dialogue for follower realizing you don't want to wait until you get home to be bound up
          should be a simple compare if time has expired
  ;fix equipFollowerAndPlayerItems to make sure it detects that we need a gag ; should detect much more
  recompile all that had getRandomHarnessAndStuff <- just item manupulate
  ;recompile all that used that new follower and player item function, needs more stuff
  
  rebase MCM vulnerablities from toggle to level
    rebuild the vulnerability function
    search through everything for iVulnerable and iNakedReq
    assign some reasonable intro values
 
  ---- switched to new dcur and ddi -----
  Need to swap DDzaZAPCArmBZaDS0* files
  ;need to filter pieces  
  ;need to detect if DDi 4.0 to save broken scripts
  ;fix POX compatibility
   
  ; random chance of finding a key
  add special finding key stuff, not just pocketing it
    - removing and masterbating
    - removing and running to player for sex
    - bringing key to player for safe keeping

    
  
  ** TODO / NOTES (bottom is most recent, older in ascending order)  --^ **
  
      +###############+
      +###############+
          Don't forget to change the version number!
      +###############+
      +###############+
  
  4.0 update: change ponygear over to new 4.0 pony gear
          change silver/gold items to ddi?
          swap over to DDi animation search function
          
  DFW todo: not this update, I bet this is going to introduce tons of hidden bugs, lets save it for a later release
   ; convert from tab characters to space
   add master support
   mcm: use Devious framework for vulnerability testing
   _qFramework = IsPlayerBound(), SetMaster(None, "", _qFramework.MD_CLOSE, True) GetVulnerability()
          
  Mods to test compatibility with:
    > naked dungeons > rape quest detection maybe?
    sexy bandit captives
    lich evilynn
    > devious followers
    kidnapped and pitfall
  
  always: new followers system needs to be tested more
  = Speed testing:
    Testing faster mods detection
    Testing if cache testing
  = need to test multiple followers for bugs
      
  Follower sold/rescue:
    Need to know if we need more than one quest per follower
    otherwise, need multiple locations where cages can be found
    select location at random, move follower there, with AI package of "do nothing" and maybe "move to location again"
    cover follower in certain gear?
  
  Follower takes you home for sex:
    Record last player home we had sex in
    bind player, teleport
     > stuff
    ends in sd enslave or just release?
    can we detect if they have a home that counts as a house? if not, last player house? if not, backup location?
  
  ItemAdding needs: CD belt + plug?
    Full CD set?
    Maybe the full set can replace everything else, so keep it open as an option even when currently locked up tight
    Harness
    
    
    &$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&&$&$&
    
    Stalker idea:
    if you say no to the same person more than once, 
        they might show up in the night and rape you in your bed, assuming it's yours
        ALT: rape cave/shack in the woods
        ALT: take them back to their home/house, we need to know that they have one though, 
          and that we can bypass tresspassing
      might also take you home with them in chains?
      or tie you up and be the master in your own house instead?
      maybe also special plug and peircings and belt, can't remove?
        they will show up and unlock you if you keep sleeping in owned beds, keeping you happy?
    : wake up fade from black, bound on bed (hope this doesn't break stuff?)
      custom house maybe if I can't get it to work for all beds
      my home is your home?
    Maybe you wake up in a castle, the guy you said no to was friends of a yarl/guards?
      Could be a decent way to get throne sex animations too
    
    Follower dialogue bugs:
    Can pop up in the middle of other stuff
      Mia stuff for one
    Need arousal minimum
    Need slave appraoch, where player is slave and we're being used
    Can get items and enslavement from this sex, bad, need safer sex for follower
    Can we detect if an item was added through script or through player's action?
    
    &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    Write to MCM:
      Chance of getting follower dialogue
      Chance follower is dom/sub
      Toggle follower can sell you up river?
      
    Creation kit access req:

    TesVEdit req:
      Can we change the form ID for the training plug?
    
    &&&&&&&&&&&&&&&&&&&&&&&&&&&&
    next big release stuff:
      rename fragment XXX to pf_crde_addDDregular01.psc
      abstract attemptapproach so we can use the same logic for crime and follower
        ; crime is dead
      make nearestRefNPC return array instead of single, so we can know if there are more than one
        good NPCs for confidence, other value checks after the first, and finally group scenes    
    

###############################################################################################################
  
Ideas for dialogue:
  
  Follower asks master for better gear at CD, start quest to go get gear?
   extended: Follower tells slave that you're going shopping at one of the two stores
  Follower wants to try dom against your slave (as s+s or m+s)
  Follower wants to try sub as d+d
  Follower wants to punish you, wear gag and sit in bondage furniture for awhile, must be in an area where they can wander around? can I force the AI to wander?
  Follower wants you to fuck the dog, while wearing a pet collar (gag too?)
    need to detect if beast stuff available, or maybe just pet collar
  Can we bribe Vel into training our followers?
  if frustrated, after sex send player to slave owner for slave training
    Which mods?
  Player is horny and needs to please men (SRR)
  Player is punished by being put in yoke and other stuff, can be approached for sex, paraded or put into furniture
  I bought this at one of the shops while you were gone
     * Gagged -> "I love it when you look at me like that" alternatives
   "Hey lets try some roleplay" -> Items with timer..?
   "did being plugged in public make you hot" -> sex or something else
     Belt option like gag.
    If follower has punished the player before, thinks they aren't DOM and sub between 1 and 5, can we send them to enslavement?
    Ask follower if items can be removed
    Ask if better items can be bought
    Ask for sex because bothered by items


  ; problem with this one is that you either ignore the other prostitution mods by making your own, or make them hard requirments
  ; ME is only alt, because ME has a separate dialogue, so we can just fall onto it
  ;player is approached for sex, asks for money because is whore
    would be great if I could link directly into certain dialogue
    Slut, service me.
      How much?
      Sure thing, 50 septims.
      < if arousal is high enough, this is replaced with do it for free>
      That lump in your pants better have some coin.
      
  player is approached for sex, declines, is thrown into nearby zaz furniture
    teleport? walking is meh
    this would be a higher priority if I could get code that would allow sex in furniture without furniture replacement
  
    
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
Unanswered Modding questions:
  is there a way to turn on/off all lighting effects (reset)
  Is there a way to quiet papyrus errors or warnings that are of no consequence? no exception/error catching it seems
  Is there a way to detect if quest states have advanced?
    like an event, you can detect if the stage has increased manually with a saved variable, but doesn't buy us much over state
  Is there a way to view the current factions an actor has in-game?
    for debugging
  Is there an event for entering a scene?
    no, but you can test if in scene, works for now
  At what moment does a pre-script for dialogue actually run?s
  can we offload "is player busy" into conditional engine?
    or any other part of the heavy papyrus
  how do we get NPCs to cast spells during dialogue
  Can we fix SD so we can sleep in their house without issues?
    ; seems like no

    
**************************************************************************************************************************

ASM Discovery:

  DO NOT use "Mods.prop != None && Mods.prop == thing"
    This compiler will get the prop from the class TWICE, probably because it thinks the state can change between the expressions

    PROPGET [ID[temptressVixenRace], ID[QQZQQ010], ID[::temp35]]
		CAST [ID[::temp41], NONE]
		CMP_EQ [ID[::temp40], ID[::temp35], ID[::temp41]]
		NOT [ID[::temp40], ID[::temp40]]
		CAST [ID[::temp39], ID[::temp40]]
		JMPF [ID[::temp39], 4]
		PROPGET [ID[temptressVixenRace], ID[QQZQQ010], ID[::temp41]]
		CMP_EQ [ID[::temp36], ID[QQZQQ029], ID[::temp41]]
		CAST [ID[::temp39], ID[::temp36]]
		JMPF [ID[::temp39], 3]
		RETURN [false]
		
  ;You should MANUALLY reuse local variables, otherwise the compiler makes a new one every single time,
  ;  per place in code, new loop? new local for that loop unless you re-specify
	;	See above where the same race we get is allocated to two different variables
	;	Different booleans are used too, even if they aren't needed further in the function
  Unlikely, but since this is byte code not machine code, it could optimize it out

  HOLY FUCKING BALLS the compiler can't rectify a double negative
  It just compiles what it sees one for one, regardless of whether it can shorten a cpu cycle off or not
 		NOT [ID[::temp22], ID[::temp22]] ; fucking pos -> neg toggle
		JMPF [ID[::temp22], 7]           ; jump on neg, instead of jump on pos
    
  This is weird, why the fuck does it need to cast from a string to an int instead of saving it as an int into the comparison??
  Almost every modern CPU instruction set lets you add a constant inline within the instruction, is this left over from xb360?
		CAST [ID[::temp391], 20]
		CMP_GE [ID[::temp393], ID[QQZQQ083], ID[::temp391]]
		CAST [ID[::temp393], ID[::temp393]]
		JMPT [ID[::temp393], 4]
		CAST [ID[::temp391], 5]
		CMP_LT [ID[::temp394], ID[QQZQQ083], ID[::temp391]]
		CAST [ID[::temp393], ID[::temp394]]
		RETURN [ID[::temp393]]

  DAMN IT getting an actorAV can HANG the fucking thread, waiting forever. Why.
  if the AV doesn't exist for the NPC make it return error at least so I can see it.
  if the NPC is broken, then... fucking put a timer on that shit?
==> CALLMETHOD GetAV ActorRef ::temp51 1 Morality
    ASSIGN actorMorality ::temp51
  
  WAT
  no seriously what fucking flag blackmagic bullshit is this
  CAST ::temp80 ::temp81
  CAST ::temp81 ::temp80
  JMPF ::temp81 13
  
    
**************************************************************************************************************************
    
  Training plug idea:
    Detects who master is
      If player attacks, punishes player <- need testing
      Player gets aroused from whiping
      Player orgasms, only when master does too
        Maybe only when going oral on master?
        "You longlingly think of your master " <- or something like that, if they aren't nearby and player is aroused
        "This <sex> just isn't the same as your master" <- sex with someone else, while not nearby to your master
      If player is not near master, and master is horny, can teleport player to them for sex
      distracts player if not in range of master
    If you try to remove it while still enslaved
      replaced with ghost plug
       until you put it back
       more consequences
        Disappears if you go waaaay far away from your master
          or if you put it back
          or switch masters
    Kinda want corisponding training collar
    If player goes through all training, some effects linger?
      if wearing plug, and/or after effects, cannot say no?
    If master puts a belt on you, and no plug, add this? Can we even catch this?
    
  Snags:
  Can't stop orgasm, can't allow orgasm when stopped by SLARUTIL
  Of course the belt stops orgasms so long as they have sl aroused
    but if collar or piercing...
  Could maybe get away with lowering almost all relationship ranks and such at hte start of sex, and them putting them back later...

***

Princess punishment collar:
 collar made by rich merchants and kings to punish daughters, might backfire
  can teleport player to location as temporary slave
  can bind them in shock gear
  can tie them up in painful furniture
  DM's posture pose furniture?
  temporary tattoos
 could be retrofit by the princess in later life for pleasure rather than pain
  can tie them up in 
 this might be beyond my willing threashold for pain to implement

&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

Follower Parts needed:

# old, break up and reorganize

Follower happiness:
  Follower dislikes being told no sex multiple times in a row if arousal is above X (90 standard?)
  Follower dislikes being hit in combat (not sure if I can detect this)
  Follower dislikes sitting still too long in the cold (not sure if I can detect this)
  Follower dislikes being given short sex
  Follower likes being given long sex
  Follower likes getting oral especially (user set happyiness based on type of sex: oral/anal/vag/boob)
  Follower likes getting to use toys
  Follower dislikes not getting his turn

Follower submission:?
  How could we guess this personality?
  User assigned in the menu maybe?
  characteristics for 
    horny, submissive, aggressive,

Player submission:
  Based on choices
  Willingness to have sex while bound (item selection)
  would be cool if there was a reverse enslave option for having a slave, that wasn't bound, that turned on you by enslaving you instead

Dialogue: 
Chance based on Follower arousal and player arousal, follower must be X aroused for over X seconds, or reach Y arousal
Follower states he's really bothered.

Extra feature: Follower can show disapointment if the user has short sex -> reactions depending on gender and available bondage gear

# this is old, look at follower dialogue instead
player is approached by friendly NPC, because NPC has noticed player likes it (()
    
    player started:
      Hold my keys? 
      Remove my items?
      Wanna sex?
      Hey check this out! I think it might look good on you!
    
    Hey, I know you like bondage, check this out! ; can we detect dead bodies and/or area with interesting treasure
      <show item they found>
      <talk about sex shop where you can buy stuff (CD,calypses?)>
    Hey, <name> lets have sex <- needs alternative
      passive answers high chance to say no, decreases with every no
      Go fuck yourself
      Or do you need a whore? Lets head to town (passive, can only use 2-3 times in a row before he grows impatient)
        Sometimes agrees, sometimes wants something else
      Yes, but lets move
        Option for public or private, even furniture?      
      No you need to calm down
        Chastity option?
        We're in bad area (excuse)
        Gag them
        Arm tie them
      
    Hey why don't we play a game?/?//
    I've noticed how much you enjoy having sex while tied up, I know this great guy who would like to tie you up.
      submissive option -> become slve
        if there was a sex with this guy, then dialogue, that would be cool but needs more work
      aggressive no if follower is slave (intimidate)
      say no
        double checked
          ...yes: points back to above
          no 
            dropped
            submissive training (needs available mods)
            rape? needs to be rare
            sex?
              ?
              
    Want to join in?
      Added actor to array, extra for sex
  follower remarks about player while player is busy with sex tied up and/or rape orgasm    

&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
  
bleed out events:
IdleForceDefaultState
BleedOutStart <- locks movement
BleedOutStop

(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)(69)

  Recompile boatloads of shit:
  add to ~/.bashrc: alias notepad="/c/Program\ Files/Notepad++/notepad++.exe"
  grep <thing> *.psc | while read -r line; do
    notepad &line
  done
    
    ; force error so we get a stack trace, useful when you get oddball throws                  
    actor test 
    Debug.Trace("keyword test: " + test.WornHasKeyword(libs.zad_DeviousPlug)) ; force err
    ; there's probably one that we can throw that wouldn't cause a second error?
    actor a 
    string s = "keyword test: " + test.WornHasKeyword(libs.zad_DeviousPlug)


  [8][8][8][8][8][8][8][8][8][8][8][8][8][8][8][8]
    Extra stuff I want to save goes below:
  [8][8][8][8][8][8][8][8][8][8][8][8][8][8][8][8]

      if tmp_follower != None && ( NPCMonitorScript.isWearingSlaveDD(tmp_follower) || Mods.isSlave(tmp_follower))

  Legume's christmas list
X 1. Removed .pex files.

X 2. Formatting: Removed some errant whitespace.

+ 3. Formatting: Removed Tabs from files.

X 4. Removed declaration of a few unused variables that were no longer (or never were) used.

5. crdedistanceenslave.psc: Added the Devious Framework Quest variable to the script.
TODO: This variable is set on each update (and when used).  It needs to be set when the game is loaded isntead.

6. crdedistanceenslave.psc: When enslaving the player if DFW is installed verify with that mod that slavery is allowed before attempting it.
This change has was made in several places for each of the different enslave options.

7. Fixed some compile issues with the crdeFollowerEnslaveScript script which I believe is obsolete.

8. crdeitemmanipulatescript.psc: Added checks to verify the "player" variable is set before it is used.
There was a comment suggesting that it was not set in one of the functions while other functions were assuming it is set.
TODO: Make sure it is set on game load (or on initialization as it never changes).

9. crdeitemmanipulatescript.psc: Consolidated the case of the zad_DeviousArmbinder being checked three times at once.

10. crdeitemmanipulatescript.psc: Removed access to the PlayerMon.player variable to reduce context switching  Use the local variable instead.

11. crdeitemmanipulatescript.psc: Commented out the Equip Random DD Debug.Notifications which were now in the "Get" function.
TODO: Left them there commented out in case we decide to find where they are now being equipped and move the notifications there.

12. crdeitemmanipulatescript.psc: Removed a couple of cases of getRandomUniqueCollar() checking for the player twice.

13. crdeitemmanipulatescript.psc: Added a missing "return None" to the end of getRandomUniqueCollar().
(It probably returned None by default so this doesn't change behaviour).

14. crdeitemmanipulatescript.psc: Moved the check for the player/actor wearing a harness from the get function to the equip function (equipRandomHarnessAndStuff).

15. crdeitemmanipulatescript.psc: Fixed the return for the equipRandomHarnessAndStuff() function.

16. crdeitemmanipulatescript.psc: Moved the "Checking Belt" notification from the get function to the equip function where the check is actually done.

17. crdelockingplugscript.psc: Reorganized if clauses in OnEquippedFilter() as I was having difficulty reading and understanding the code.

18. crdemcmscript.psc: Added some code to GetVersion() to set the DFW main and MCM variables.
TODO Investigate: This function is supposed to be called on each game load but that doesn't appear to be happening.

19. crdemcmscript.psc: Removed the initial empty page.

20. crdemcmscript.psc: Added a last page variable so the MCM menu opens to the last viewed page.

21. crdemcmscript.psc: Added a UpdateScript() function for initializing/updating script variables.

22. crdemcmscript.psc: Separated the large "If a_page... next page" into separate functions for each page for organization purposes.

23. crdemcmscript.psc: Updated use of the fEventTimeoutHours variable (in several places).
There is a possibility I just updated it because it was difficult for me to understand but I don't think that is the case.
I don't remember why I made this change (some time ago) but something tells me there was an actual problem with the way it was so I didn't want to loose the changes.

24. crdemcmscript.psc: Removed a second blank line between "Nighttime Options" and "Vulnerable items".  Was this intended/desired?

25. crdemcmscript.psc: Added a "DFW Compatibility" page with:
a. "Prefer DFW Behaviour" - Intended for users to be able to turn off DFW changes and keep the old functionality.  Primarily for stability in the event of unforseen problems.
b. "Security Level" - Added an option for the users to be able to lock themselves out of the menus when vulnerable.  This still needs to be applied to lockout many of the existing MCM settings.
c. "Percent Modify Vulnerability" - An option for fine tuning DFW vulnerability for this mod.
d. "Minimum Vulnerability Sex" - The minimum DFW vulnerability the player must have before she will be considered vulnerable for sex.
                                 Intended to replace most, if not all of the DEC vulnerability options but both will be used until any non-redundant vulnerabilities can be accounted for.
e. "Minimum Vulnerability Enslave" - Same as "Minimum Vulnerability Sex" but for enslavement.
f. "Percent Vulnerability Sex" - Increase the chances of sex when vulnerable.
g. "Percent Vulnerability Enslave" - Same as "Percent Vulnerability Enslave" but for enslavement.
h. "Sex Reduction When Enslaved" - Reduces (or increases) the chance of sex when enslaved by another mod.

26. crdemcmscript.psc: Removed a couple of isntances of casting a float to a float.

27. crdemodsmonitorscript.psc: If using DFW checking for the player being a slave is moved to attemptApproach()  Removed it from the isPlayerEnslaved() function.

28. crdeplayermonitorscript.psc: Removed the sslThreadLibrary as it is not used anywhere.

29. crdeplayermonitorscript.psc: Changed the use of the timeoutEnslaveGameTime variable (in several places).
There is a possibility I just updated it because it was difficult for me to understand but I don't think that is the case.
I don't remember why I made this change (some time ago) but something tells me there was an actual problem with the way it was so I didn't want to loose the changes.
It has been renamed to fLastEnslaveAttempt which holds the exact time of the enslavement attempt (we used to store the time of the end of the timeout).
One effect of this change is updating the MCM timeout after this time has been recorded can now take effect and can be used to shorten (or lengthen) the timeout.

30. crdeplayermonitorscript.psc: Changed the Thread Busy flag from a boolean to an integer.
The integer now counts down and times out automatically if the script does not clear it properly (on badly timed saves?).

31. crdeplayermonitorscript.psc: Added script version checking to each update poll of the script (to update the script).
TODO: This needs to be done on game load rather than on each version.

32. crdeplayermonitorscript.psc: If using DFW, we don't even consider the approach if the player is not vulnerable enough (according to DFW).
This is done early to reduce a lot of possible checks and load on the papyrus engine but isn't as dynamic as checking the player's vulnerability against a large number of variables, especially basing the player's vulnerability on the attacker which isn't even looked at.

33. crdeplayermonitorscript.psc: If using DFW, we don't even consider the approach if DFW reports the player cannot be enslaved and cannot engage in sex.
TODO: The approach can now be done to have the follower equip restraints on the player?  We probably want the approach to be allowed for this case if DFW reports restraints can be added to the player.

34. crdeplayermonitorscript.psc: Added a debug message when attempting the approach.

35. crdeplayermonitorscript.psc: During the enslavement attempt if the player is too far away, instead of aborting I changed it to teleport (MoveTo) the player to the agressor's location.

36. crdeplayermonitorscript.psc: During the enslavement attempt I attempt to register the agressor as the player's master and fail the enslavement if this can't be done.
I am using None as the agressor with no mod.  This means the master does not later need to be cleared but provides some basic enslavement registration.

37. crdeplayermonitorscript.psc: When enslaving the player post sex, added a check with DFW to verify the player can be enslaved.

38. crdeplayermonitorscript.psc: When adding restraints to the player post sex, added a check with DFW to verify the player can be restrained.

39. crdeplayermonitorscript.psc: If the getClosestRefActor() fails to find an actor I added code to get the nearest dominant from DFW.
I found a case during testing when DEC could not find an actor but there were some nearby and I couldn't figure out why they weren't detected.

30. crdeplayermonitorscript.psc: Changed follower_thinks_player_sub to be cumulative of several values.
I think this was a bug.  The variable was being set and then overwritten without being used in between.

40. crdeplayermonitorscript.psc: Rewrote the sex/enslavement roll in attemptApproach() to include DFW.
Added a redundant check to make sure the player is vulnerable enough and sex/enslavement is allowed.
Accounts for MCM adjustments based on current DFW vulnerability and when the player is enslaved.
Originally this would remove the need for chastity detection here if DFW is installed but with the new bChastityToggle chastity detection is now needed regardless.

41. crdeplayermonitorscript.psc: Added some code to use the DFW vulnerability in attemptApproach() when DEC decides on enslavement but detects the player is not vulnerable enough.
If we get to this point the player should already have passed the vulnerability detection and I encountered a problem where the player's vulnerability was being evaluated incorrectly.

42. crdeplayermonitorscript.psc: Changed the enslavement vulnerability check to happen only if not using DFW.  If using DFW this is done elsewhere.

43. crdeplayermonitorscript.psc: Changed the code so that if enslavement is selected but fails for any reason sex is attempted instead.

44. crdesexlabactoralias.psc: Fixed a compile error.  I believe the script is obsolete.

45. crdeslaverunscript.psc: Fixed a spelling mistake/compile error.

46. crdestartquestscript.psc: Increased the version number to 13.7.2.

47. crdetrainingeffect.psc: Fixed a compile error.  I believe the script is obsolete.

48. Topic Info Fragments: Changed the use of the timeoutEnslaveGameTime variable (in several places).
There is a possibility I just updated it because it was difficult for me to understand but I don't think that is the case.
I don't remember why I made this change (some time ago) but something tells me there was an actual problem with the way it was so I didn't want to loose the changes.
The following topic info fragments were updated accordingly:
pf_crde_enslavelonelywithnoownersight.psc
pf_crde_enslaveluckydayslavenomaster.psc
pf_crde_enslaverunningerrandsorrun.psc
pf_crde_enslaveslaverunningnomaster.psc
pf_crde_enslaveyoulookalone.psc
pf_crde_sexfreefuckservice.psc
pf_crde_sexmycockrequires.psc
pf_crde_sexmypussyrequires.psc
pf_crde_sexslutserviceme.psc
tif__080022f0.psc
tif__080022f3.psc
tif__080022f4.psc
tif__08002311.psc
tif__080038ad.psc
tif__080038ae.psc
tif__0800437b.psc
tif__0800437c.psc
tif__0800437d.psc

49. pf_crde_followergaggedaddblindfold.psc: Fixed a compile error accessing an undeclared variable.      

***** new MCM option

* references *
string[] Property genderList Auto

event OnOptionMenuOpen(int a_option)
if a_option == iGenderPrefOID
  SetMenuDialogStartIndex(iGenderPref)
  SetMenuDialogDefaultIndex(0)
  SetMenuDialogOptions(genderList)

event OnOptionMenuAccept(int a_option, int a_index)
  {Called when the user accepts a new menu entry}  
  if a_option == iGenderPrefOID
    iGenderPref = a_index
    SetMenuOptionValue(a_option, genderList[iGenderPref])

iGenderPrefMasterOID    = AddMenuOption("Master Gender Preference", genderList[iGenderPrefMaster])

*<>*
; actual
string[] Property singleVulnerabilities Auto





